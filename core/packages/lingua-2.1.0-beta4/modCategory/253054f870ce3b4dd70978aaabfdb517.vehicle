<?php return array (
  'unique_key' => 'category',
  'preserve_keys' => false,
  'update_object' => true,
  'related_objects' => 
  array (
    'Snippets' => 
    array (
      '4741802567ae756fe14445c1451ac61d' => 
      array (
        'preserve_keys' => false,
        'update_object' => true,
        'unique_key' => 'name',
        'class' => 'modSnippet',
        'object' => '{"id":0,"source":0,"property_preprocess":1,"name":"lingua.selector","description":"Languages selector drop down.","editor_type":0,"category":0,"cache_type":0,"snippet":"\\/**\\n * Lingua\\n *\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\n *\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\n *\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\n * terms of the GNU General Public License as published by the Free Software\\n * Foundation version 3.\\n *\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\n *\\n * You should have received a copy of the GNU General Public License along with\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\n * Suite 330, Boston, MA 02111-1307 USA\\n *\\n * @package lingua\\n * @subpackage lingua_selector\\n *\\/\\n$activeOnly = $modx->getOption(\'activeOnly\', $scriptProperties, \'1\');\\n$tplWrapper = $modx->getOption(\'tplWrapper\', $scriptProperties, \'lingua.selector.wrapper\');\\n$tplItem = $modx->getOption(\'tplItem\', $scriptProperties, \'lingua.selector.item\');\\n$langKey = $modx->getOption(\'getKey\', $scriptProperties, $modx->getOption(\'lingua.get_key\', null, \'lang\'));\\n$sortby = $modx->getOption(\'sortby\', $scriptProperties, \'id\');\\n$sortdir = $modx->getOption(\'sortdir\', $scriptProperties, \'asc\');\\n$phsPrefix = $modx->getOption(\'phsPrefix\', $scriptProperties, \'lingua.\');\\n$codeField = $modx->getOption(\'codeField\', $scriptProperties, \'lang_code\');\\n\\n$defaultLinguaCorePath = $modx->getOption(\'core_path\') . \'components\\/lingua\\/\';\\n$linguaCorePath = $modx->getOption(\'lingua.core_path\', null, $defaultLinguaCorePath);\\n$lingua = $modx->getService(\'lingua\', \'Lingua\', $linguaCorePath . \'model\\/lingua\\/\', $scriptProperties);\\n\\nif (!($lingua instanceof Lingua)) {\\n    return;\\n}\\n\\n$allowedContexts = $modx->getOption(\'lingua.contexts\');\\n$allowedContexts = array_map(\'trim\', @explode(\',\', $allowedContexts));\\n$currentContext = $modx->context->get(\'key\');\\nif (!in_array($currentContext, $allowedContexts)) {\\n    return;\\n}\\n\\n$pageURL = \'http\';\\nif (isset($_SERVER[\\"HTTPS\\"]) && $_SERVER[\\"HTTPS\\"] == \\"on\\") {\\n    $pageURL .= \\"s\\";\\n}\\n$pageURL .= \\":\\/\\/\\";\\nif ($_SERVER[\\"SERVER_PORT\\"] !== \\"80\\") {\\n    $pageURL .= $_SERVER[\\"SERVER_NAME\\"] . \\":\\" . $_SERVER[\\"SERVER_PORT\\"] . $_SERVER[\\"REQUEST_URI\\"];\\n} else {\\n    $pageURL .= $_SERVER[\\"SERVER_NAME\\"] . $_SERVER[\\"REQUEST_URI\\"];\\n}\\n$parseUrl = parse_url($pageURL);\\nif (!empty($parseUrl[\'query\'])) {\\n    \\/**\\n     * http:\\/\\/stackoverflow.com\\/a\\/7753154\\/1246646\\n     *\\/\\n    if (!function_exists(\'http_build_url\')) {\\n        define(\'HTTP_URL_REPLACE\', 1);              \\/\\/ Replace every part of the first URL when there\'s one of the second URL\\n        define(\'HTTP_URL_JOIN_PATH\', 2);            \\/\\/ Join relative paths\\n        define(\'HTTP_URL_JOIN_QUERY\', 4);           \\/\\/ Join query strings\\n        define(\'HTTP_URL_STRIP_USER\', 8);           \\/\\/ Strip any user authentication information\\n        define(\'HTTP_URL_STRIP_PASS\', 16);          \\/\\/ Strip any password authentication information\\n        define(\'HTTP_URL_STRIP_AUTH\', 32);          \\/\\/ Strip any authentication information\\n        define(\'HTTP_URL_STRIP_PORT\', 64);          \\/\\/ Strip explicit port numbers\\n        define(\'HTTP_URL_STRIP_PATH\', 128);         \\/\\/ Strip complete path\\n        define(\'HTTP_URL_STRIP_QUERY\', 256);        \\/\\/ Strip query string\\n        define(\'HTTP_URL_STRIP_FRAGMENT\', 512);     \\/\\/ Strip any fragments (#identifier)\\n        define(\'HTTP_URL_STRIP_ALL\', 1024);         \\/\\/ Strip anything but scheme and host\\n\\n        \\/**\\n         * Build an URL<br>\\n         * The parts of the second URL will be merged into the first according to the flags argument.<br><br>\\n         *\\n         * @param\\tmixed\\t$url\\t(Part(s) of) an URL in form of a string or associative array like parse_url() returns\\n         * @param\\tmixed\\t$parts\\tSame as the first argument\\n         * @param\\tint\\t\\t$flags\\tA bitmask of binary or\'ed HTTP_URL constants (Optional)HTTP_URL_REPLACE is the default\\n         * @param\\tarray\\t$newUrl\\tIf set, it will be filled with the parts of the composed url like parse_url() would return\\n         * @return\\tstring\\t\\t\\tBuilt URL\\n         *\\/\\n        function http_build_url($url, $parts = array(), $flags = HTTP_URL_REPLACE, &$newUrl = false) {\\n            $keys = array(\'user\', \'pass\', \'port\', \'path\', \'query\', \'fragment\');\\n\\n            \\/\\/ HTTP_URL_STRIP_ALL becomes all the HTTP_URL_STRIP_Xs\\n            if ($flags & HTTP_URL_STRIP_ALL) {\\n                $flags |= HTTP_URL_STRIP_USER;\\n                $flags |= HTTP_URL_STRIP_PASS;\\n                $flags |= HTTP_URL_STRIP_PORT;\\n                $flags |= HTTP_URL_STRIP_PATH;\\n                $flags |= HTTP_URL_STRIP_QUERY;\\n                $flags |= HTTP_URL_STRIP_FRAGMENT;\\n            }\\n            \\/\\/ HTTP_URL_STRIP_AUTH becomes HTTP_URL_STRIP_USER and HTTP_URL_STRIP_PASS\\n            else if ($flags & HTTP_URL_STRIP_AUTH) {\\n                $flags |= HTTP_URL_STRIP_USER;\\n                $flags |= HTTP_URL_STRIP_PASS;\\n            }\\n\\n            \\/\\/ Parse the original URL\\n            $parseUrl = parse_url($url);\\n\\n            \\/\\/ Scheme and Host are always replaced\\n            if (isset($parts[\'scheme\']))\\n                $parseUrl[\'scheme\'] = $parts[\'scheme\'];\\n            if (isset($parts[\'host\']))\\n                $parseUrl[\'host\'] = $parts[\'host\'];\\n\\n            \\/\\/ (If applicable) Replace the original URL with it\'s new parts\\n            if ($flags & HTTP_URL_REPLACE) {\\n                foreach ($keys as $key) {\\n                    if (isset($parts[$key]))\\n                        $parseUrl[$key] = $parts[$key];\\n                }\\n            }\\n            else {\\n                \\/\\/ Join the original URL path with the new path\\n                if (isset($parts[\'path\']) && ($flags & HTTP_URL_JOIN_PATH)) {\\n                    if (isset($parseUrl[\'path\']))\\n                        $parseUrl[\'path\'] = rtrim(str_replace(basename($parseUrl[\'path\']), \'\', $parseUrl[\'path\']), \'\\/\') . \'\\/\' . ltrim($parts[\'path\'], \'\\/\');\\n                    else\\n                        $parseUrl[\'path\'] = $parts[\'path\'];\\n                }\\n\\n                \\/\\/ Join the original query string with the new query string\\n                if (isset($parts[\'query\']) && ($flags & HTTP_URL_JOIN_QUERY)) {\\n                    if (isset($parseUrl[\'query\']))\\n                        $parseUrl[\'query\'] .= \'&\' . $parts[\'query\'];\\n                    else\\n                        $parseUrl[\'query\'] = $parts[\'query\'];\\n                }\\n            }\\n\\n            \\/\\/ Strips all the applicable sections of the URL\\n            \\/\\/ Note: Scheme and Host are never stripped\\n            foreach ($keys as $key) {\\n                if ($flags & (int) constant(\'HTTP_URL_STRIP_\' . strtoupper($key)))\\n                    unset($parseUrl[$key]);\\n            }\\n\\n            $newUrl = $parseUrl;\\n\\n            return\\n                    ((isset($parseUrl[\'scheme\'])) ? $parseUrl[\'scheme\'] . \':\\/\\/\' : \'\')\\n                    . ((isset($parseUrl[\'user\'])) ? $parseUrl[\'user\'] . ((isset($parseUrl[\'pass\'])) ? \':\' . $parseUrl[\'pass\'] : \'\') . \'@\' : \'\')\\n                    . ((isset($parseUrl[\'host\'])) ? $parseUrl[\'host\'] : \'\')\\n                    . ((isset($parseUrl[\'port\'])) ? \':\' . $parseUrl[\'port\'] : \'\')\\n                    . ((isset($parseUrl[\'path\'])) ? $parseUrl[\'path\'] : \'\')\\n                    . ((isset($parseUrl[\'query\'])) ? \'?\' . $parseUrl[\'query\'] : \'\')\\n                    . ((isset($parseUrl[\'fragment\'])) ? \'#\' . $parseUrl[\'fragment\'] : \'\')\\n            ;\\n        }\\n\\n    }\\n\\n    parse_str($parseUrl[\'query\'], $queries);\\n    unset($queries[$langKey]);\\n    $parseUrl[\'query\'] = http_build_query($queries);\\n\\n    $pageURL = http_build_url($pageURL, $parseUrl);\\n    $pageURL = urldecode($pageURL);\\n    \\/\\/ replace: &queryarray[0]=foo&queryarray[1]=bar\\n    \\/\\/ to:\\t\\t&queryarray[]=foo&queryarray[]=bar\\n    $pageURL = preg_replace(\'\\/\\\\[+(\\\\d)+\\\\]+\\/\', \'[]\', $pageURL);\\n}\\n\\n$pageURL = rtrim($pageURL, \'?\');\\n$hasQuery = strstr($pageURL, \'?\');\\n\\n$originPageUrl = $pageURL;\\n$requestUri = preg_replace(\'\\/^\'. preg_quote(MODX_BASE_URL, \'\\/\') . \'\\/i\', \'\', $parseUrl[\'path\']);\\n\\n\\/\\/ $modx->getOption(\'cultureKey\') is overriden by plugin!\\n$modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\n$cultureKey = $modCultureKey->get(\'value\');\\n\\n$baseUrl = $modx->getOption(\'base_url\', $scriptProperties);\\n$baseUrl = preg_replace(\'\\/^\'. preg_quote(MODX_BASE_URL, \'\\/\') . \'\\/i\', \'\', $baseUrl);\\n$originResource = $modx->getObject(\'modResource\', $modx->resource->get(\'id\'));\\n\\n$languages = $lingua->getLanguages($activeOnly);\\n$selections = array();\\nforeach ($languages as $language) {\\n    if ($language[\'lang_code\'] === $modx->cultureKey) {\\n        continue;\\n    }\\n\\n    $cloneSite = $modx->getObject(\'linguaSiteContent\', array(\\n        \'resource_id\' => $modx->resource->get(\'id\'),\\n        \'lang_id\' => $language[\'id\'],\\n    ));\\n    if ($modx->getOption(\'friendly_urls\')) {\\n        $itemUri = \'\';\\n        if ($language[\'lang_code\'] === $cultureKey) {\\n            $itemUri = $originResource->get(\'uri\');\\n        } elseif ($cloneSite) {\\n            $itemUri = $cloneSite->get(\'uri\');\\n        }\\n        if (!empty($itemUri)) {\\n            if ((int)$modx->getOption(\'site_start\') === $modx->resource->get(\'id\')) {\\n                $pageURL = $parseUrl[\'scheme\'] . \':\\/\\/\' . $parseUrl[\'host\'] . \'\\/\' . $parseUrl[\'path\'] . $itemUri;\\n            } else {\\n                $pageURL = preg_replace(\'\\/^\' . preg_quote($parseUrl[\'scheme\'] . \':\\/\\/\' . $parseUrl[\'host\'] . \'\\/\' . $requestUri, \'\\/\') . \'\\/i\'\\n                        , $parseUrl[\'scheme\'] . \':\\/\\/\' . $parseUrl[\'host\'] . \'\\/\' . $baseUrl . $itemUri\\n                        , $originPageUrl);\\n            }\\n        }\\n    }\\n\\n    $language[\'url\'] = $pageURL . (!empty($hasQuery) ? \'&\' : \'?\') . $langKey . \'=\' . $language[$codeField];\\n    $phs = $lingua->setPlaceholders($language, $phsPrefix, false);\\n\\n    if (!empty($toArray)) {\\n        $selections[] = $phs;\\n    } else {\\n        $selections[] = $lingua->parseTpl($tplItem, $phs);\\n    }\\n}\\n\\nif (!empty($toArray)) {\\n    $wrapper = array(\\n        $phsPrefix . \'languages\' => $selections\\n    );\\n    $output = \'<pre>\' . print_r($wrapper, TRUE) . \'<\\/pre>\';\\n} else {\\n    $selection = @implode(\\"\\\\n\\", $selections);\\n    $wrapper = array($phsPrefix . \'languages\' => $selection);\\n    $output = $lingua->parseTpl($tplWrapper, $wrapper);\\n}\\nif (!empty($toPlaceholder)) {\\n    $modx->setPlaceholder($toPlaceholder, $output);\\n    return;\\n}\\nreturn $output;","locked":0,"properties":"a:7:{s:9:\\"codeField\\";a:7:{s:4:\\"name\\";s:9:\\"codeField\\";s:4:\\"desc\\";s:19:\\"prop_codeField_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:9:\\"lang_code\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"getKey\\";a:7:{s:4:\\"name\\";s:6:\\"getKey\\";s:4:\\"desc\\";s:16:\\"prop_getKey_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:4:\\"lang\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:9:\\"phsPrefix\\";a:7:{s:4:\\"name\\";s:9:\\"phsPrefix\\";s:4:\\"desc\\";s:19:\\"prop_phsPrefix_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:7:\\"lingua.\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"sortby\\";a:7:{s:4:\\"name\\";s:6:\\"sortby\\";s:4:\\"desc\\";s:16:\\"prop_sortby_desc\\";s:4:\\"type\\";s:4:\\"list\\";s:7:\\"options\\";a:2:{i:0;a:2:{s:4:\\"text\\";s:2:\\"ID\\";s:5:\\"value\\";s:2:\\"id\\";}i:1;a:2:{s:4:\\"text\\";s:8:\\"iso_code\\";s:5:\\"value\\";s:8:\\"iso_code\\";}}s:5:\\"value\\";s:2:\\"id\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"sortdir\\";a:7:{s:4:\\"name\\";s:7:\\"sortdir\\";s:4:\\"desc\\";s:17:\\"prop_sortdir_desc\\";s:4:\\"type\\";s:4:\\"list\\";s:7:\\"options\\";a:2:{i:0;a:2:{s:4:\\"text\\";s:3:\\"ASC\\";s:5:\\"value\\";s:3:\\"asc\\";}i:1;a:2:{s:4:\\"text\\";s:4:\\"DESC\\";s:5:\\"value\\";s:4:\\"desc\\";}}s:5:\\"value\\";s:3:\\"asc\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"tplItem\\";a:7:{s:4:\\"name\\";s:7:\\"tplItem\\";s:4:\\"desc\\";s:17:\\"prop_tplItem_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:20:\\"lingua.selector.item\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"tplWrapper\\";a:7:{s:4:\\"name\\";s:10:\\"tplWrapper\\";s:4:\\"desc\\";s:20:\\"prop_tplWrapper_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:23:\\"lingua.selector.wrapper\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}}","moduleguid":"","static":0,"static_file":"","content":"\\/**\\n * Lingua\\n *\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\n *\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\n *\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\n * terms of the GNU General Public License as published by the Free Software\\n * Foundation version 3.\\n *\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\n *\\n * You should have received a copy of the GNU General Public License along with\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\n * Suite 330, Boston, MA 02111-1307 USA\\n *\\n * @package lingua\\n * @subpackage lingua_selector\\n *\\/\\n$activeOnly = $modx->getOption(\'activeOnly\', $scriptProperties, \'1\');\\n$tplWrapper = $modx->getOption(\'tplWrapper\', $scriptProperties, \'lingua.selector.wrapper\');\\n$tplItem = $modx->getOption(\'tplItem\', $scriptProperties, \'lingua.selector.item\');\\n$langKey = $modx->getOption(\'getKey\', $scriptProperties, $modx->getOption(\'lingua.get_key\', null, \'lang\'));\\n$sortby = $modx->getOption(\'sortby\', $scriptProperties, \'id\');\\n$sortdir = $modx->getOption(\'sortdir\', $scriptProperties, \'asc\');\\n$phsPrefix = $modx->getOption(\'phsPrefix\', $scriptProperties, \'lingua.\');\\n$codeField = $modx->getOption(\'codeField\', $scriptProperties, \'lang_code\');\\n\\n$defaultLinguaCorePath = $modx->getOption(\'core_path\') . \'components\\/lingua\\/\';\\n$linguaCorePath = $modx->getOption(\'lingua.core_path\', null, $defaultLinguaCorePath);\\n$lingua = $modx->getService(\'lingua\', \'Lingua\', $linguaCorePath . \'model\\/lingua\\/\', $scriptProperties);\\n\\nif (!($lingua instanceof Lingua)) {\\n    return;\\n}\\n\\n$allowedContexts = $modx->getOption(\'lingua.contexts\');\\n$allowedContexts = array_map(\'trim\', @explode(\',\', $allowedContexts));\\n$currentContext = $modx->context->get(\'key\');\\nif (!in_array($currentContext, $allowedContexts)) {\\n    return;\\n}\\n\\n$pageURL = \'http\';\\nif (isset($_SERVER[\\"HTTPS\\"]) && $_SERVER[\\"HTTPS\\"] == \\"on\\") {\\n    $pageURL .= \\"s\\";\\n}\\n$pageURL .= \\":\\/\\/\\";\\nif ($_SERVER[\\"SERVER_PORT\\"] !== \\"80\\") {\\n    $pageURL .= $_SERVER[\\"SERVER_NAME\\"] . \\":\\" . $_SERVER[\\"SERVER_PORT\\"] . $_SERVER[\\"REQUEST_URI\\"];\\n} else {\\n    $pageURL .= $_SERVER[\\"SERVER_NAME\\"] . $_SERVER[\\"REQUEST_URI\\"];\\n}\\n$parseUrl = parse_url($pageURL);\\nif (!empty($parseUrl[\'query\'])) {\\n    \\/**\\n     * http:\\/\\/stackoverflow.com\\/a\\/7753154\\/1246646\\n     *\\/\\n    if (!function_exists(\'http_build_url\')) {\\n        define(\'HTTP_URL_REPLACE\', 1);              \\/\\/ Replace every part of the first URL when there\'s one of the second URL\\n        define(\'HTTP_URL_JOIN_PATH\', 2);            \\/\\/ Join relative paths\\n        define(\'HTTP_URL_JOIN_QUERY\', 4);           \\/\\/ Join query strings\\n        define(\'HTTP_URL_STRIP_USER\', 8);           \\/\\/ Strip any user authentication information\\n        define(\'HTTP_URL_STRIP_PASS\', 16);          \\/\\/ Strip any password authentication information\\n        define(\'HTTP_URL_STRIP_AUTH\', 32);          \\/\\/ Strip any authentication information\\n        define(\'HTTP_URL_STRIP_PORT\', 64);          \\/\\/ Strip explicit port numbers\\n        define(\'HTTP_URL_STRIP_PATH\', 128);         \\/\\/ Strip complete path\\n        define(\'HTTP_URL_STRIP_QUERY\', 256);        \\/\\/ Strip query string\\n        define(\'HTTP_URL_STRIP_FRAGMENT\', 512);     \\/\\/ Strip any fragments (#identifier)\\n        define(\'HTTP_URL_STRIP_ALL\', 1024);         \\/\\/ Strip anything but scheme and host\\n\\n        \\/**\\n         * Build an URL<br>\\n         * The parts of the second URL will be merged into the first according to the flags argument.<br><br>\\n         *\\n         * @param\\tmixed\\t$url\\t(Part(s) of) an URL in form of a string or associative array like parse_url() returns\\n         * @param\\tmixed\\t$parts\\tSame as the first argument\\n         * @param\\tint\\t\\t$flags\\tA bitmask of binary or\'ed HTTP_URL constants (Optional)HTTP_URL_REPLACE is the default\\n         * @param\\tarray\\t$newUrl\\tIf set, it will be filled with the parts of the composed url like parse_url() would return\\n         * @return\\tstring\\t\\t\\tBuilt URL\\n         *\\/\\n        function http_build_url($url, $parts = array(), $flags = HTTP_URL_REPLACE, &$newUrl = false) {\\n            $keys = array(\'user\', \'pass\', \'port\', \'path\', \'query\', \'fragment\');\\n\\n            \\/\\/ HTTP_URL_STRIP_ALL becomes all the HTTP_URL_STRIP_Xs\\n            if ($flags & HTTP_URL_STRIP_ALL) {\\n                $flags |= HTTP_URL_STRIP_USER;\\n                $flags |= HTTP_URL_STRIP_PASS;\\n                $flags |= HTTP_URL_STRIP_PORT;\\n                $flags |= HTTP_URL_STRIP_PATH;\\n                $flags |= HTTP_URL_STRIP_QUERY;\\n                $flags |= HTTP_URL_STRIP_FRAGMENT;\\n            }\\n            \\/\\/ HTTP_URL_STRIP_AUTH becomes HTTP_URL_STRIP_USER and HTTP_URL_STRIP_PASS\\n            else if ($flags & HTTP_URL_STRIP_AUTH) {\\n                $flags |= HTTP_URL_STRIP_USER;\\n                $flags |= HTTP_URL_STRIP_PASS;\\n            }\\n\\n            \\/\\/ Parse the original URL\\n            $parseUrl = parse_url($url);\\n\\n            \\/\\/ Scheme and Host are always replaced\\n            if (isset($parts[\'scheme\']))\\n                $parseUrl[\'scheme\'] = $parts[\'scheme\'];\\n            if (isset($parts[\'host\']))\\n                $parseUrl[\'host\'] = $parts[\'host\'];\\n\\n            \\/\\/ (If applicable) Replace the original URL with it\'s new parts\\n            if ($flags & HTTP_URL_REPLACE) {\\n                foreach ($keys as $key) {\\n                    if (isset($parts[$key]))\\n                        $parseUrl[$key] = $parts[$key];\\n                }\\n            }\\n            else {\\n                \\/\\/ Join the original URL path with the new path\\n                if (isset($parts[\'path\']) && ($flags & HTTP_URL_JOIN_PATH)) {\\n                    if (isset($parseUrl[\'path\']))\\n                        $parseUrl[\'path\'] = rtrim(str_replace(basename($parseUrl[\'path\']), \'\', $parseUrl[\'path\']), \'\\/\') . \'\\/\' . ltrim($parts[\'path\'], \'\\/\');\\n                    else\\n                        $parseUrl[\'path\'] = $parts[\'path\'];\\n                }\\n\\n                \\/\\/ Join the original query string with the new query string\\n                if (isset($parts[\'query\']) && ($flags & HTTP_URL_JOIN_QUERY)) {\\n                    if (isset($parseUrl[\'query\']))\\n                        $parseUrl[\'query\'] .= \'&\' . $parts[\'query\'];\\n                    else\\n                        $parseUrl[\'query\'] = $parts[\'query\'];\\n                }\\n            }\\n\\n            \\/\\/ Strips all the applicable sections of the URL\\n            \\/\\/ Note: Scheme and Host are never stripped\\n            foreach ($keys as $key) {\\n                if ($flags & (int) constant(\'HTTP_URL_STRIP_\' . strtoupper($key)))\\n                    unset($parseUrl[$key]);\\n            }\\n\\n            $newUrl = $parseUrl;\\n\\n            return\\n                    ((isset($parseUrl[\'scheme\'])) ? $parseUrl[\'scheme\'] . \':\\/\\/\' : \'\')\\n                    . ((isset($parseUrl[\'user\'])) ? $parseUrl[\'user\'] . ((isset($parseUrl[\'pass\'])) ? \':\' . $parseUrl[\'pass\'] : \'\') . \'@\' : \'\')\\n                    . ((isset($parseUrl[\'host\'])) ? $parseUrl[\'host\'] : \'\')\\n                    . ((isset($parseUrl[\'port\'])) ? \':\' . $parseUrl[\'port\'] : \'\')\\n                    . ((isset($parseUrl[\'path\'])) ? $parseUrl[\'path\'] : \'\')\\n                    . ((isset($parseUrl[\'query\'])) ? \'?\' . $parseUrl[\'query\'] : \'\')\\n                    . ((isset($parseUrl[\'fragment\'])) ? \'#\' . $parseUrl[\'fragment\'] : \'\')\\n            ;\\n        }\\n\\n    }\\n\\n    parse_str($parseUrl[\'query\'], $queries);\\n    unset($queries[$langKey]);\\n    $parseUrl[\'query\'] = http_build_query($queries);\\n\\n    $pageURL = http_build_url($pageURL, $parseUrl);\\n    $pageURL = urldecode($pageURL);\\n    \\/\\/ replace: &queryarray[0]=foo&queryarray[1]=bar\\n    \\/\\/ to:\\t\\t&queryarray[]=foo&queryarray[]=bar\\n    $pageURL = preg_replace(\'\\/\\\\[+(\\\\d)+\\\\]+\\/\', \'[]\', $pageURL);\\n}\\n\\n$pageURL = rtrim($pageURL, \'?\');\\n$hasQuery = strstr($pageURL, \'?\');\\n\\n$originPageUrl = $pageURL;\\n$requestUri = preg_replace(\'\\/^\'. preg_quote(MODX_BASE_URL, \'\\/\') . \'\\/i\', \'\', $parseUrl[\'path\']);\\n\\n\\/\\/ $modx->getOption(\'cultureKey\') is overriden by plugin!\\n$modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\n$cultureKey = $modCultureKey->get(\'value\');\\n\\n$baseUrl = $modx->getOption(\'base_url\', $scriptProperties);\\n$baseUrl = preg_replace(\'\\/^\'. preg_quote(MODX_BASE_URL, \'\\/\') . \'\\/i\', \'\', $baseUrl);\\n$originResource = $modx->getObject(\'modResource\', $modx->resource->get(\'id\'));\\n\\n$languages = $lingua->getLanguages($activeOnly);\\n$selections = array();\\nforeach ($languages as $language) {\\n    if ($language[\'lang_code\'] === $modx->cultureKey) {\\n        continue;\\n    }\\n\\n    $cloneSite = $modx->getObject(\'linguaSiteContent\', array(\\n        \'resource_id\' => $modx->resource->get(\'id\'),\\n        \'lang_id\' => $language[\'id\'],\\n    ));\\n    if ($modx->getOption(\'friendly_urls\')) {\\n        $itemUri = \'\';\\n        if ($language[\'lang_code\'] === $cultureKey) {\\n            $itemUri = $originResource->get(\'uri\');\\n        } elseif ($cloneSite) {\\n            $itemUri = $cloneSite->get(\'uri\');\\n        }\\n        if (!empty($itemUri)) {\\n            if ((int)$modx->getOption(\'site_start\') === $modx->resource->get(\'id\')) {\\n                $pageURL = $parseUrl[\'scheme\'] . \':\\/\\/\' . $parseUrl[\'host\'] . \'\\/\' . $parseUrl[\'path\'] . $itemUri;\\n            } else {\\n                $pageURL = preg_replace(\'\\/^\' . preg_quote($parseUrl[\'scheme\'] . \':\\/\\/\' . $parseUrl[\'host\'] . \'\\/\' . $requestUri, \'\\/\') . \'\\/i\'\\n                        , $parseUrl[\'scheme\'] . \':\\/\\/\' . $parseUrl[\'host\'] . \'\\/\' . $baseUrl . $itemUri\\n                        , $originPageUrl);\\n            }\\n        }\\n    }\\n\\n    $language[\'url\'] = $pageURL . (!empty($hasQuery) ? \'&\' : \'?\') . $langKey . \'=\' . $language[$codeField];\\n    $phs = $lingua->setPlaceholders($language, $phsPrefix, false);\\n\\n    if (!empty($toArray)) {\\n        $selections[] = $phs;\\n    } else {\\n        $selections[] = $lingua->parseTpl($tplItem, $phs);\\n    }\\n}\\n\\nif (!empty($toArray)) {\\n    $wrapper = array(\\n        $phsPrefix . \'languages\' => $selections\\n    );\\n    $output = \'<pre>\' . print_r($wrapper, TRUE) . \'<\\/pre>\';\\n} else {\\n    $selection = @implode(\\"\\\\n\\", $selections);\\n    $wrapper = array($phsPrefix . \'languages\' => $selection);\\n    $output = $lingua->parseTpl($tplWrapper, $wrapper);\\n}\\nif (!empty($toPlaceholder)) {\\n    $modx->setPlaceholder($toPlaceholder, $output);\\n    return;\\n}\\nreturn $output;"}',
        'guid' => '79d4779adf8246e657af5930eacf95de',
        'native_key' => 0,
        'signature' => 'aa2847b1354f900be35d30f57c70fe2c',
      ),
      '7a75576285897f7b2ecf7d25d0b69212' => 
      array (
        'preserve_keys' => false,
        'update_object' => true,
        'unique_key' => 'name',
        'class' => 'modSnippet',
        'object' => '{"id":0,"source":0,"property_preprocess":1,"name":"lingua.cultureKey","description":"Helper snippet to get the run time cultureKey, which is set by lingua\'s plugin.","editor_type":0,"category":0,"cache_type":0,"snippet":"\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_culture_key\\r\\n *\\/\\r\\n\\r\\nreturn $modx->cultureKey;","locked":0,"properties":null,"moduleguid":"","static":0,"static_file":"","content":"\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_culture_key\\r\\n *\\/\\r\\n\\r\\nreturn $modx->cultureKey;"}',
        'guid' => '42201882fa1e7686d1c79253a85c464b',
        'native_key' => 0,
        'signature' => 'd3e3e9ef20d67e049990cebca94efd4e',
      ),
      'a671ff1408588e238e4f05e3bf36692b' => 
      array (
        'preserve_keys' => false,
        'update_object' => true,
        'unique_key' => 'name',
        'class' => 'modSnippet',
        'object' => '{"id":0,"source":0,"property_preprocess":1,"name":"lingua.getField","description":"Get the value of the given field for the run time culture key.","editor_type":0,"category":0,"cache_type":0,"snippet":"\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_getfield\\r\\n *\\/\\r\\n\\r\\n$field = $modx->getOption(\'field\', $scriptProperties);\\r\\nif (empty($field)) {\\r\\n    return;\\r\\n}\\r\\n\\r\\n$langCodeField = $modx->getOption(\'codeField\', $scriptProperties, $modx->getOption(\'lingua.code_field\', null, \'lang_code\'));\\r\\n$defaultLinguaCorePath = $modx->getOption(\'core_path\') . \'components\\/lingua\\/\';\\r\\n$linguaCorePath = $modx->getOption(\'lingua.core_path\', null, $defaultLinguaCorePath);\\r\\n$lingua = $modx->getService(\'lingua\', \'Lingua\', $linguaCorePath . \'model\\/lingua\\/\', $scriptProperties);\\r\\n\\r\\nif (!($lingua instanceof Lingua)) {\\r\\n    return;\\r\\n}\\r\\n\\r\\n$langObj = $modx->getObject(\'linguaLangs\', array(\\r\\n    $langCodeField => $modx->cultureKey\\r\\n));\\r\\nif (!$langObj) {\\r\\n    return;\\r\\n}\\r\\n$output = $langObj->get($field);\\r\\nif (!$output) {\\r\\n    return;\\r\\n}\\r\\nreturn $output;","locked":0,"properties":null,"moduleguid":"","static":0,"static_file":"","content":"\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_getfield\\r\\n *\\/\\r\\n\\r\\n$field = $modx->getOption(\'field\', $scriptProperties);\\r\\nif (empty($field)) {\\r\\n    return;\\r\\n}\\r\\n\\r\\n$langCodeField = $modx->getOption(\'codeField\', $scriptProperties, $modx->getOption(\'lingua.code_field\', null, \'lang_code\'));\\r\\n$defaultLinguaCorePath = $modx->getOption(\'core_path\') . \'components\\/lingua\\/\';\\r\\n$linguaCorePath = $modx->getOption(\'lingua.core_path\', null, $defaultLinguaCorePath);\\r\\n$lingua = $modx->getService(\'lingua\', \'Lingua\', $linguaCorePath . \'model\\/lingua\\/\', $scriptProperties);\\r\\n\\r\\nif (!($lingua instanceof Lingua)) {\\r\\n    return;\\r\\n}\\r\\n\\r\\n$langObj = $modx->getObject(\'linguaLangs\', array(\\r\\n    $langCodeField => $modx->cultureKey\\r\\n));\\r\\nif (!$langObj) {\\r\\n    return;\\r\\n}\\r\\n$output = $langObj->get($field);\\r\\nif (!$output) {\\r\\n    return;\\r\\n}\\r\\nreturn $output;"}',
        'guid' => '44ba2e6d34fa25ecbe5ead3ca9b48c08',
        'native_key' => 0,
        'signature' => '71a7efd27eb824db3ba43439991b52fa',
      ),
      '07f88b1758caddd0d7db00cf9652ff37' => 
      array (
        'preserve_keys' => false,
        'update_object' => true,
        'unique_key' => 'name',
        'class' => 'modSnippet',
        'object' => '{"id":0,"source":0,"property_preprocess":1,"name":"lingua.getValue","description":"Get the value of the clone\'s field for the run time culture key.","editor_type":0,"category":0,"cache_type":0,"snippet":"\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_getfield\\r\\n *\\/\\r\\n\\r\\n$field = $modx->getOption(\'field\', $scriptProperties);\\r\\nif (empty($field)) {\\r\\n    return;\\r\\n}\\r\\n\\r\\n$id = $modx->getOption(\'id\', $scriptProperties, $modx->resource->get(\'id\'));\\r\\n$emptyReturnsDefault = $modx->getOption(\'emptyReturnsDefault\', $scriptProperties, $modx->getOption(\'lingua.empty_returns_default\', null, false));\\r\\n\\r\\n$defaultLinguaCorePath = $modx->getOption(\'core_path\') . \'components\\/lingua\\/\';\\r\\n$linguaCorePath = $modx->getOption(\'lingua.core_path\', null, $defaultLinguaCorePath);\\r\\n$lingua = $modx->getService(\'lingua\', \'Lingua\', $linguaCorePath . \'model\\/lingua\\/\', $scriptProperties);\\r\\n$debug = $modx->getOption(\'lingua.debug\');\\r\\nif (!($lingua instanceof Lingua)) {\\r\\n    $modx->log(modX::LOG_LEVEL_ERROR, \'[lingua.getValue]: !($lingua instanceof Lingua)\');\\r\\n    return;\\r\\n}\\r\\n\\r\\n$langObj = $modx->getObject(\'linguaLangs\', array(\\r\\n    \'lang_code\' => $modx->cultureKey\\r\\n));\\r\\nif (!$langObj) {\\r\\n    if ($debug) {\\r\\n        $modx->log(modX::LOG_LEVEL_ERROR, \'[lingua.getValue]: Missing field\\\\\'s value for \' . $field . \' in \' . $modx->cultureKey);\\r\\n    }\\r\\n    return;\\r\\n}\\r\\n$c = $modx->newQuery(\'linguaSiteContent\');\\r\\n$c->where(array(\\r\\n    \'resource_id\' => $id,\\r\\n    \'lang_id\' => $langObj->get(\'id\'),\\r\\n));\\r\\n$linguaSiteContent = $modx->getObject(\'linguaSiteContent\', $c);\\r\\n$resource = $modx->getObject(\'modResource\', $id);\\r\\nif (!$resource) {\\r\\n    if ($debug) {\\r\\n        $modx->log(modX::LOG_LEVEL_ERROR, \'[lingua.getValue]: Missing resource for \' . $field . \' in \' . $modx->cultureKey);\\r\\n    }\\r\\n    return;\\r\\n}\\r\\n\\r\\n$tableFields = array(\'pagetitle\', \'longtitle\', \'description\', \'alias\',\\r\\n    \'link_attributes\', \'introtext\', \'content\', \'menutitle\', \'uri\', \'uri_override\',\\r\\n    \'properties\');\\r\\n$output = \'\';\\r\\nif (in_array($field, $tableFields)) {\\r\\n    if ($linguaSiteContent) {\\r\\n        $output = $linguaSiteContent->get($field);\\r\\n        if (empty($output)) {\\r\\n            if ($emptyReturnsDefault) {\\r\\n                $output = $resource->get($field); \\/\\/ return default language\'s value\\r\\n            }\\r\\n        }\\r\\n    } else {\\r\\n        $output = $resource->get($field); \\/\\/ return default language\'s value\\r\\n    }\\r\\n}\\r\\n\\/\\/ try TV\\r\\nelse {\\r\\n    $tv = $modx->getObject(\'modTemplateVar\', array(\\r\\n        \'name\' => $field,\\r\\n    ));\\r\\n    if ($tv) {\\r\\n        $linguaSiteTmplvarContentvalues = $modx->getObject(\'linguaSiteTmplvarContentvalues\', array(\\r\\n            \'lang_id\' => $langObj->get(\'id\'),\\r\\n            \'tmplvarid\' => $tv->get(\'id\'),\\r\\n            \'contentid\' => $id,\\r\\n        ));\\r\\n        if ($linguaSiteTmplvarContentvalues) {\\r\\n            $value = $linguaSiteTmplvarContentvalues->get(\'value\');\\r\\n            $tv->set(\'resourceId\', $id);\\r\\n            if (empty($value) && !$emptyReturnsDefault) {\\r\\n                $tv->set(\'value\', $value); \\/\\/ return empty value\\r\\n            } else {\\r\\n                $tv->set(\'value\', $value);\\r\\n            }\\r\\n        }\\r\\n        $output = $tv->renderOutput($resource->get(\'id\'));\\r\\n    }\\r\\n}\\r\\n\\r\\nreturn $output;","locked":0,"properties":"a:7:{s:9:\\"codeField\\";a:7:{s:4:\\"name\\";s:9:\\"codeField\\";s:4:\\"desc\\";s:19:\\"prop_codeField_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:9:\\"lang_code\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"getKey\\";a:7:{s:4:\\"name\\";s:6:\\"getKey\\";s:4:\\"desc\\";s:16:\\"prop_getKey_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:4:\\"lang\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:9:\\"phsPrefix\\";a:7:{s:4:\\"name\\";s:9:\\"phsPrefix\\";s:4:\\"desc\\";s:19:\\"prop_phsPrefix_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:7:\\"lingua.\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:6:\\"sortby\\";a:7:{s:4:\\"name\\";s:6:\\"sortby\\";s:4:\\"desc\\";s:16:\\"prop_sortby_desc\\";s:4:\\"type\\";s:4:\\"list\\";s:7:\\"options\\";a:2:{i:0;a:2:{s:4:\\"text\\";s:2:\\"ID\\";s:5:\\"value\\";s:2:\\"id\\";}i:1;a:2:{s:4:\\"text\\";s:8:\\"iso_code\\";s:5:\\"value\\";s:8:\\"iso_code\\";}}s:5:\\"value\\";s:2:\\"id\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"sortdir\\";a:7:{s:4:\\"name\\";s:7:\\"sortdir\\";s:4:\\"desc\\";s:17:\\"prop_sortdir_desc\\";s:4:\\"type\\";s:4:\\"list\\";s:7:\\"options\\";a:2:{i:0;a:2:{s:4:\\"text\\";s:3:\\"ASC\\";s:5:\\"value\\";s:3:\\"asc\\";}i:1;a:2:{s:4:\\"text\\";s:4:\\"DESC\\";s:5:\\"value\\";s:4:\\"desc\\";}}s:5:\\"value\\";s:3:\\"asc\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:7:\\"tplItem\\";a:7:{s:4:\\"name\\";s:7:\\"tplItem\\";s:4:\\"desc\\";s:17:\\"prop_tplItem_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:20:\\"lingua.selector.item\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}s:10:\\"tplWrapper\\";a:7:{s:4:\\"name\\";s:10:\\"tplWrapper\\";s:4:\\"desc\\";s:20:\\"prop_tplWrapper_desc\\";s:4:\\"type\\";s:9:\\"textfield\\";s:7:\\"options\\";s:0:\\"\\";s:5:\\"value\\";s:23:\\"lingua.selector.wrapper\\";s:7:\\"lexicon\\";s:15:\\"lingua:property\\";s:4:\\"area\\";s:0:\\"\\";}}","moduleguid":"","static":0,"static_file":"","content":"\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_getfield\\r\\n *\\/\\r\\n\\r\\n$field = $modx->getOption(\'field\', $scriptProperties);\\r\\nif (empty($field)) {\\r\\n    return;\\r\\n}\\r\\n\\r\\n$id = $modx->getOption(\'id\', $scriptProperties, $modx->resource->get(\'id\'));\\r\\n$emptyReturnsDefault = $modx->getOption(\'emptyReturnsDefault\', $scriptProperties, $modx->getOption(\'lingua.empty_returns_default\', null, false));\\r\\n\\r\\n$defaultLinguaCorePath = $modx->getOption(\'core_path\') . \'components\\/lingua\\/\';\\r\\n$linguaCorePath = $modx->getOption(\'lingua.core_path\', null, $defaultLinguaCorePath);\\r\\n$lingua = $modx->getService(\'lingua\', \'Lingua\', $linguaCorePath . \'model\\/lingua\\/\', $scriptProperties);\\r\\n$debug = $modx->getOption(\'lingua.debug\');\\r\\nif (!($lingua instanceof Lingua)) {\\r\\n    $modx->log(modX::LOG_LEVEL_ERROR, \'[lingua.getValue]: !($lingua instanceof Lingua)\');\\r\\n    return;\\r\\n}\\r\\n\\r\\n$langObj = $modx->getObject(\'linguaLangs\', array(\\r\\n    \'lang_code\' => $modx->cultureKey\\r\\n));\\r\\nif (!$langObj) {\\r\\n    if ($debug) {\\r\\n        $modx->log(modX::LOG_LEVEL_ERROR, \'[lingua.getValue]: Missing field\\\\\'s value for \' . $field . \' in \' . $modx->cultureKey);\\r\\n    }\\r\\n    return;\\r\\n}\\r\\n$c = $modx->newQuery(\'linguaSiteContent\');\\r\\n$c->where(array(\\r\\n    \'resource_id\' => $id,\\r\\n    \'lang_id\' => $langObj->get(\'id\'),\\r\\n));\\r\\n$linguaSiteContent = $modx->getObject(\'linguaSiteContent\', $c);\\r\\n$resource = $modx->getObject(\'modResource\', $id);\\r\\nif (!$resource) {\\r\\n    if ($debug) {\\r\\n        $modx->log(modX::LOG_LEVEL_ERROR, \'[lingua.getValue]: Missing resource for \' . $field . \' in \' . $modx->cultureKey);\\r\\n    }\\r\\n    return;\\r\\n}\\r\\n\\r\\n$tableFields = array(\'pagetitle\', \'longtitle\', \'description\', \'alias\',\\r\\n    \'link_attributes\', \'introtext\', \'content\', \'menutitle\', \'uri\', \'uri_override\',\\r\\n    \'properties\');\\r\\n$output = \'\';\\r\\nif (in_array($field, $tableFields)) {\\r\\n    if ($linguaSiteContent) {\\r\\n        $output = $linguaSiteContent->get($field);\\r\\n        if (empty($output)) {\\r\\n            if ($emptyReturnsDefault) {\\r\\n                $output = $resource->get($field); \\/\\/ return default language\'s value\\r\\n            }\\r\\n        }\\r\\n    } else {\\r\\n        $output = $resource->get($field); \\/\\/ return default language\'s value\\r\\n    }\\r\\n}\\r\\n\\/\\/ try TV\\r\\nelse {\\r\\n    $tv = $modx->getObject(\'modTemplateVar\', array(\\r\\n        \'name\' => $field,\\r\\n    ));\\r\\n    if ($tv) {\\r\\n        $linguaSiteTmplvarContentvalues = $modx->getObject(\'linguaSiteTmplvarContentvalues\', array(\\r\\n            \'lang_id\' => $langObj->get(\'id\'),\\r\\n            \'tmplvarid\' => $tv->get(\'id\'),\\r\\n            \'contentid\' => $id,\\r\\n        ));\\r\\n        if ($linguaSiteTmplvarContentvalues) {\\r\\n            $value = $linguaSiteTmplvarContentvalues->get(\'value\');\\r\\n            $tv->set(\'resourceId\', $id);\\r\\n            if (empty($value) && !$emptyReturnsDefault) {\\r\\n                $tv->set(\'value\', $value); \\/\\/ return empty value\\r\\n            } else {\\r\\n                $tv->set(\'value\', $value);\\r\\n            }\\r\\n        }\\r\\n        $output = $tv->renderOutput($resource->get(\'id\'));\\r\\n    }\\r\\n}\\r\\n\\r\\nreturn $output;"}',
        'guid' => '1d8b2753e70c59a2dd4006e79546f16d',
        'native_key' => 0,
        'signature' => 'fd9ee56f91228ed058a9995ae128d135',
      ),
    ),
    'Plugins' => 
    array (
      '29a90f4e95a4aaeef554259f3d19a7db' => 
      array (
        'preserve_keys' => false,
        'update_object' => true,
        'unique_key' => 'name',
        'class' => 'modPlugin',
        'object' => '{"id":0,"source":0,"property_preprocess":1,"name":"Lingua","description":"","editor_type":0,"category":0,"cache_type":0,"plugincode":"header(\'Content-Type: text\\/html; charset=utf-8\');\\r\\n\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_plugin\\r\\n *\\/\\r\\n$event = $modx->event->name;\\r\\nswitch ($event) {\\r\\n    case \'OnHandleRequest\': \\/\\/ for global\\r\\n        break;\\r\\n\\r\\n    case \'OnInitCulture\':   \\/\\/ for request class\\r\\n        if ($modx->context->key === \'mgr\') {\\r\\n            return;\\r\\n        }\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n        $modx->lexicon->load(\'lingua:default\');\\r\\n        $langGetKey = $modx->getOption(\'lingua.request_key\', $scriptProperties, \'lang\');\\r\\n        $langGetKeyValue = filter_input(INPUT_GET, $langGetKey, FILTER_SANITIZE_STRING);\\r\\n        $langGetKeyValue = strtolower($langGetKeyValue);\\r\\n        $langCookieValue = filter_input(INPUT_COOKIE, \'modx_lingua_switcher\', FILTER_SANITIZE_STRING);\\r\\n        $langCookieValue = strtolower($langCookieValue);\\r\\n        if (!empty($langGetKeyValue) &&\\r\\n                $langGetKeyValue !== $modx->cultureKey &&\\r\\n                strlen($langGetKeyValue) === 2\\r\\n        ) {\\r\\n            $lingua->setCultureKey($langGetKeyValue);\\r\\n        } else if (!empty($langCookieValue) &&\\r\\n                $langCookieValue !== $modx->cultureKey &&\\r\\n                strlen($langCookieValue) === 2\\r\\n        ) {\\r\\n            $lingua->setCultureKey($langCookieValue);\\r\\n        } else if(empty($langGetKeyValue) &&\\r\\n                empty($langCookieValue)\\r\\n        ){\\r\\n            $detectBrowser = $modx->getOption(\'lingua.detect_browser\');\\r\\n            if ($detectBrowser === \'1\') {\\r\\n                $languages = explode(\',\', filter_input(INPUT_SERVER, \'HTTP_ACCEPT_LANGUAGE\', FILTER_SANITIZE_STRING));\\r\\n                $sortedLangs = array();\\r\\n                foreach ($languages as $language) {\\r\\n                    $language = strtolower($language);\\r\\n                    $parts = @explode(\';\', $language);\\r\\n                    if (!isset($parts[1])) {\\r\\n                        $sort = 1.0;\\r\\n                    } else {\\r\\n                        $x = @explode(\'=\', $parts[1]);\\r\\n                        $sort = $x[1] - 0;\\r\\n                    }\\r\\n                    $sortedLangs[$parts[0]] = $sort;\\r\\n                }\\r\\n                arsort($sortedLangs);\\r\\n                $langs = array_keys($sortedLangs);\\r\\n                $linguaLangs = $modx->getCollection(\'linguaLangs\', array(\\r\\n                    \'active\' => 1\\r\\n                ));\\r\\n                $c = $modx->newQuery(\'linguaLangs\');\\r\\n                $c->where(\'active=1\');\\r\\n                $contextLangs = $modx->context->config[\'lingua.langs\'];\\r\\n                if (!empty($contextLangs)) {\\r\\n                    $contextLangs = array_map(\'trim\', @explode(\',\', $contextLangs));\\r\\n                    $c->where(array(\\r\\n                        \'lang_code:IN\' => $contextLangs\\r\\n                    ));\\r\\n                }\\r\\n                $linguaLangs = $modx->getCollection(\'linguaLangs\', $c);\\r\\n                $existingLangs = array();\\r\\n                if ($linguaLangs) {\\r\\n                    foreach ($linguaLangs as $linguaLang) {\\r\\n                        $existingLangs[] = $linguaLang->get(\'lang_code\');\\r\\n                    }\\r\\n                }\\r\\n\\r\\n                $acceptedLangs = array_intersect($existingLangs, $langs);\\r\\n                $acceptedLangs = array_values($acceptedLangs); \\/\\/ reset index\\r\\n\\r\\n                if (!empty($acceptedLangs) && is_array($acceptedLangs)) {\\r\\n                    $lingua->setCultureKey($acceptedLangs[0]);\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n        $modx->cultureKey = $lingua->getCultureKey();\\r\\n        if ($modx->cultureKey !== $modx->getOption(\'cultureKey\')) {\\r\\n            $modx->setOption(\'cultureKey\', $modx->cultureKey);\\r\\n            $modx->context->config[\'cultureKey\'] = $modx->cultureKey;\\r\\n        }\\r\\n        $modx->setPlaceholder(\'lingua.cultureKey\', $modx->cultureKey);\\r\\n        $modx->setPlaceholder(\'lingua.language\', $modx->cultureKey);\\r\\n\\r\\n        break;\\r\\n\\r\\n    \\/**\\r\\n     * \\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/ MANAGER SIDE \\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\r\\n     *\\/\\r\\n    case \'OnDocFormPrerender\':\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            if ($resource) {\\r\\n                $currentContext = $resource->get(\'context_key\');\\r\\n            } else {\\r\\n                $currentContext = filter_input(INPUT_GET, \'context_key\', FILTER_SANITIZE_STRING);\\r\\n            }\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            if ($resource) {\\r\\n                $currentParent = $resource->get(\'parent\');\\r\\n            } else {\\r\\n                $currentParent = filter_input(INPUT_GET, \'parent\', FILTER_SANITIZE_NUMBER_INT);\\r\\n            }\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        if (is_object($resource)) {\\r\\n            $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n            if (!empty($ids)) {\\r\\n                $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n                $currentId = $resource->get(\'id\');\\r\\n                if (!in_array($currentId, $ids)) {\\r\\n                    return;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        $modx->lexicon->load(\'lingua:default\');\\r\\n        $languages = $lingua->getLanguages();\\r\\n        if (empty($languages)) {\\r\\n            return;\\r\\n        }\\r\\n        $modx->regClientCSS(MODX_BASE_URL . \'assets\\/components\\/lingua\\/css\\/mgr.css\');\\r\\n        $modx->controller->addLastJavascript(MODX_BASE_URL . \'assets\\/components\\/lingua\\/js\\/mgr\\/resource.js\');\\r\\n        \\/\\/ $modx->getOption(\'cultureKey\') doesn\'t work!\\r\\n        $modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\r\\n        $cultureKey = $modCultureKey->get(\'value\');\\r\\n        $storeData = array();\\r\\n        $storeDefaultData = array();\\r\\n        $configLang = array();\\r\\n        $linguaSiteContentArray = array();\\r\\n        $createHiddenFields = array();\\r\\n        foreach ($languages as $language) {\\r\\n            $configLang[$language[\'lang_code\']] = array(\\r\\n                \'lang_code\' => $language[\'lang_code\'],\\r\\n                \'local_name\' => $language[\'local_name\'],\\r\\n                \'flag\' => $language[\'flag\'],\\r\\n            );\\r\\n            if ($language[\'lang_code\'] === $cultureKey) {\\r\\n                $storeDefaultData[] = array(\\r\\n                    $language[\'lang_code\'],\\r\\n                    $language[\'local_name\'],\\r\\n                    $language[\'flag\'],\\r\\n                );\\r\\n                continue;\\r\\n            }\\r\\n            $storeData[] = array(\\r\\n                $language[\'lang_code\'],\\r\\n                $language[\'local_name\'],\\r\\n                $language[\'flag\'],\\r\\n            );\\r\\n            if ($mode === modSystemEvent::MODE_UPD) {\\r\\n                $linguaSiteContent = $modx->getObject(\'linguaSiteContent\', array(\\r\\n                    \'resource_id\' => $resource->get(\'id\'),\\r\\n                    \'lang_id\' => $language[\'id\']\\r\\n                ));\\r\\n                if ($linguaSiteContent) {\\r\\n                    $linguaSiteContentArray[$language[\'lang_code\']] = $linguaSiteContent->toArray();\\r\\n                } else {\\r\\n                    $linguaSiteContentArray[$language[\'lang_code\']] = array();\\r\\n                }\\r\\n            } else {\\r\\n                $linguaSiteContentArray[$language[\'lang_code\']] = array();\\r\\n            }\\r\\n            $modx->regClientStartupHTMLBlock(\'<style>.icon-lingua-flag-\' . $language[\'lcid_string\'] . \' {background-image: url(\\\\\'..\\/\' . $language[\'flag\'] . \'\\\\\'); background-repeat: no-repeat;}<\\/style>\');\\r\\n            $createHiddenFields[] = $language;\\r\\n        } \\/\\/ foreach ($languages as $language)\\r\\n        \\/\\/------------------------------------------------------------------\\r\\n        $formCustomized = $modx->getOption(\'lingua.form_customization\');\\r\\n        $modx->controller->addHtml(\'\\r\\n<script type=\\"text\\/javascript\\">\\r\\nExt.onReady(function() {\\r\\n    window.lingua = new Lingua({\\r\\n        defaultLang: \\"\' . $cultureKey . \'\\",\\r\\n        langs: \' . json_encode($configLang) . \',\\r\\n        siteContent: \' . json_encode($linguaSiteContentArray) . \',\\r\\n        formCustomized: \' . $formCustomized . \'\\r\\n    });\\r\\n    lingua.flagDefaultFields();\\r\\n    lingua.createHiddenFields(\' . json_encode($createHiddenFields) . \');\\r\\n    lingua.getMenu({\\r\\n        storeData: \' . json_encode(array_merge($storeDefaultData, $storeData)) . \'\\r\\n    });\\r\\n});\\r\\n<\\/script>\');\\r\\n        if ($formCustomized) {\\r\\n            $modx->controller->addLastJavascript(MODX_BASE_URL . \'assets\\/components\\/lingua\\/js\\/mgr\\/fcinit.js\');\\r\\n        }\\r\\n        \\/\\/------------------------------------------------------------------\\r\\n        break;\\r\\n\\r\\n    case \'OnResourceTVFormRender\':\\r\\n        if (!is_object($resource) && is_numeric($resource)) {\\r\\n            $resourceId = $resource;\\r\\n            $resource = $modx->getObject(\'modResource\', $resource);\\r\\n        }\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            if ($resource) {\\r\\n                $currentContext = $resource->get(\'context_key\');\\r\\n            } else {\\r\\n                $currentContext = filter_input(INPUT_GET, \'context_key\', FILTER_SANITIZE_STRING);\\r\\n            }\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            if ($resource) {\\r\\n                $currentParent = $resource->get(\'parent\');\\r\\n            } else {\\r\\n                $currentParent = filter_input(INPUT_GET, \'parent\', FILTER_SANITIZE_NUMBER_INT);\\r\\n            }\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        if (is_object($resource)) {\\r\\n            $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n            if (!empty($ids)) {\\r\\n                $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n                $currentId = $resource->get(\'id\');\\r\\n                if (!in_array($currentId, $ids)) {\\r\\n                    return;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n        $languages = $lingua->getLanguages(true, false);\\r\\n        if (empty($languages)) {\\r\\n            return;\\r\\n        }\\r\\n        $initAllClonedTVFields = array();\\r\\n        foreach ($languages as $language) {\\r\\n            $initAllClonedTVFields[] = $language;\\r\\n        }\\r\\n\\r\\n        if ($resource) {\\r\\n            $tvs = $resource->getTemplateVars();\\r\\n        } else {\\r\\n            $templateId = $template;\\r\\n            $template = $modx->getObject(\'modTemplate\', $templateId);\\r\\n            $tvs = $template->getTemplateVars();\\r\\n        }\\r\\n        if (!$tvs) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        $tvIds = array();\\r\\n        $tvOutputs = array();\\r\\n        foreach ($tvs as $tv) {\\r\\n            $tvIds[] = $tv->get(\'id\');\\r\\n        }\\r\\n        $c = $modx->newQuery(\'linguaSiteTmplvars\');\\r\\n        $c->where(array(\\r\\n            \'tmplvarid:IN\' => $tvIds\\r\\n        ));\\r\\n        $linguaSiteTmplvars = $modx->getCollection(\'linguaSiteTmplvars\', $c);\\r\\n        if (!$linguaSiteTmplvars) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        $formElements = array();\\r\\n        foreach ($scriptProperties[\'categories\'] as $category) {\\r\\n            foreach ($category[\'tvs\'] as $tv) {\\r\\n                $formElements[$tv->get(\'id\')] = $tv;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        if (!empty($modx->controller->scriptProperties[\'showCheckbox\'])) {\\r\\n            $showCheckbox = 1;\\r\\n        }\\r\\n\\r\\n        $tmplvars = array();\\r\\n        $cloneTVFields = array();\\r\\n        $count = 0;\\r\\n        \\/\\/ $modx->getOption(\'cultureKey\') doesn\'t work!\\r\\n        $modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\r\\n        $cultureKey = $modCultureKey->get(\'value\');\\r\\n        foreach ($linguaSiteTmplvars as $linguaTv) {\\r\\n            $tvId = $linguaTv->get(\'tmplvarid\');\\r\\n            if (!isset($formElements[$tvId])) {\\r\\n                continue;\\r\\n            }\\r\\n            $tv = $formElements[$tvId];\\r\\n            $tmplvars[] = array(\\r\\n                \'id\' => $tvId,\\r\\n                \'type\' => $tv->get(\'type\'),\\r\\n            );\\r\\n            $tvArray = $tv->toArray(\'tv.\');\\r\\n            foreach ($languages as $language) {\\r\\n                if ($language[\'lang_code\'] === $cultureKey) {\\r\\n                    continue;\\r\\n                }\\r\\n                $linguaTVContent = $modx->getObject(\'linguaSiteTmplvarContentvalues\', array(\\r\\n                    \'tmplvarid\' => $tvId,\\r\\n                    \'contentid\' => $resourceId,\\r\\n                    \'lang_id\' => $language[\'id\']\\r\\n                ));\\r\\n                \\/\\/ Start to manipulate the ID to parse hidden TVs\\r\\n                $content = \'\';\\r\\n                if ($linguaTVContent) {\\r\\n                    $content = $linguaTVContent->get(\'value\');\\r\\n                }\\r\\n                \\/\\/ Hack TV\'s value because renderInput ignores empty value\\r\\n                $tv->set(\'value\', $content);\\r\\n                $inputForm = $tv->renderInput($resource, array(\\r\\n                    \'value\' => $content\\r\\n                ));\\r\\n                if (empty($inputForm)) {\\r\\n                    continue;\\r\\n                }\\r\\n                $tvCloneId = $tvId . \'_\' . $language[\'lang_code\'] . \'_lingua_tv\';\\r\\n                \\/\\/ basic replacements\\r\\n                $cloneInputForm = $inputForm;\\r\\n                $cloneInputForm = preg_replace(\'\\/(\\"|\\\\\'){1}tv\' . $tvId . \'(\\"|\\\\\'){1}\\/\', \'${1}tv\' . $tvCloneId . \'${2}\', $cloneInputForm);\\r\\n                $cloneInputForm = preg_replace(\'\\/(\\"|\\\\\'){1}tv\' . $tvId . \'\\\\[\\\\](\\"|\\\\\'){1}\\/\', \'${1}tv\' . $tvCloneId . \'[]${2}\', $cloneInputForm);\\r\\n                \\/\\/ advanced replacements\\r\\n                $linguaSiteTmplvarsPatterns = $modx->getCollection(\'linguaSiteTmplvarsPatterns\', array(\\r\\n                    \'type\' => $tv->get(\'type\')\\r\\n                ));\\r\\n                if ($linguaSiteTmplvarsPatterns) {\\r\\n                    foreach ($linguaSiteTmplvarsPatterns as $pattern) {\\r\\n                        $search = $pattern->get(\'search\');\\r\\n                        $search = str_replace(\'{{tvId}}\', $tvId, $search);\\r\\n                        $replacement = $pattern->get(\'replacement\');\\r\\n                        $replacement = str_replace(\'{{tvCloneId}}\', $tvCloneId, $replacement);\\r\\n                        $cloneInputForm = preg_replace($search, $replacement, $cloneInputForm);\\r\\n                    }\\r\\n                }\\r\\n                $count++;\\r\\n                $phs = $tvArray;\\r\\n                $phs[\'tv.id\'] = $tvCloneId;\\r\\n                $phs[\'tv.formElement\'] = $cloneInputForm;\\r\\n                $phs[\'tv.showCheckbox\'] = $showCheckbox;\\r\\n                $cloneTVFields[] = $lingua->processElementTags($lingua->parseTpl(\'lingua.resourcetv.row\', $phs));\\r\\n            }\\r\\n        }\\r\\n\\r\\n        \\/\\/ reset any left out output after rendering TV forms above\\r\\n        if ($modx->event->name === \'OnTVInputRenderList\') {\\r\\n            $modx->event->_output = \'\';\\r\\n        }\\r\\n        $modx->event->output(@implode(\\"\\\\n\\", $cloneTVFields));\\r\\n        $jsHTML = \\"\\r\\n<script>\\r\\n    Ext.onReady(function() {\\r\\n        lingua.config.tmplvars = \\" . json_encode($tmplvars) . \\";\\r\\n        lingua.initAllClonedTVFields(\\" . json_encode($initAllClonedTVFields) . \\");\\r\\n        lingua.flagDefaultTVFields();\\r\\n    });\\r\\n<\\/script>\\";\\r\\n        $modx->event->output($jsHTML);\\r\\n\\r\\n        break;\\r\\n\\r\\n    case \'OnDocFormSave\':\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            $currentContext = $resource->get(\'context_key\');\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            $currentParent = $resource->get(\'parent\');\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n        if (!empty($ids)) {\\r\\n            $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n            $currentId = $resource->get(\'id\');\\r\\n            if (!in_array($currentId, $ids)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        \\/\\/ update linguaSiteContent\\r\\n        $reverting = array();\\r\\n        $clearKeys = array();\\r\\n        \\/\\/ $modx->getOption(\'cultureKey\') doesn\'t work!\\r\\n        $modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\r\\n        $cultureKey = $modCultureKey->get(\'value\');\\r\\n        foreach ($resource->_fields as $k => $v) {\\r\\n            if (!preg_match(\'\\/_lingua$\\/\', $k)) {\\r\\n                continue;\\r\\n            }\\r\\n            foreach ($v as $a => $b) {\\r\\n                if ($a === $cultureKey) {\\r\\n                    continue;\\r\\n                }\\r\\n                $reverting[$a][preg_replace(\'\\/_lingua$\\/\', \'\', $k)] = $b;\\r\\n            }\\r\\n            $clearKeys[] = $k;\\r\\n        }\\r\\n\\r\\n        $resourceId = $resource->get(\'id\');\\r\\n        foreach ($reverting as $k => $v) {\\r\\n            $lingua->setContentTranslation($resourceId, $k, $v);\\r\\n        }\\r\\n\\r\\n        \\/\\/ update linguaSiteTmplvarContentvalues\\r\\n        $reverting = array();\\r\\n        foreach ($resource->_fields as $k => $value) {\\r\\n            if (!preg_match(\'\\/_lingua_tv$\\/\', $k)) {\\r\\n                continue;\\r\\n            }\\r\\n            $tvKey = preg_replace(\'\\/_lingua_tv$\\/\', \'\', $k);\\r\\n            $tvKeys = @explode(\'_\', $tvKey);\\r\\n            $tvId = str_replace(\'tv\', \'\', $tvKeys[0]);\\r\\n            if (!is_numeric($tvId)) {\\r\\n                continue;\\r\\n            }\\r\\n            $reverse = array_reverse($tvKeys);\\r\\n            $lang = $reverse[0];\\r\\n            if ($lang === $cultureKey) {\\r\\n                continue;\\r\\n            }\\r\\n            $tv = $modx->getObject(\'modTemplateVar\', $tvId);\\r\\n            $tvKey = $tvKeys[0];\\r\\n            \\/* validation for different types *\\/\\r\\n            switch ($tv->get(\'type\')) {\\r\\n                case \'url\':\\r\\n                    \\/\\/ tv16_prefix_id_lingua_tv\\r\\n                    $prefix = $resource->_fields[$tvKey . \'_prefix_\' . $lang . \'_lingua_tv\'];\\r\\n                    if ($prefix != \'--\') {\\r\\n                        $value = str_replace(array(\'ftp:\\/\\/\', \'http:\\/\\/\', \'https:\\/\\/\', \'ftp:\\/\\/\', \'mailto:\'), \'\', $value);\\r\\n                        $value = $prefix . $value;\\r\\n                    }\\r\\n                    $reverting[$lang][$tvId] = $value;\\r\\n\\r\\n                    break;\\r\\n                case \'date\':\\r\\n                    $value = empty($value) ? \'\' : strftime(\'%Y-%m-%d %H:%M:%S\', strtotime($value));\\r\\n\\r\\n                    break;\\r\\n                \\/* ensure tag types trim whitespace from tags *\\/\\r\\n                case \'tag\':\\r\\n                case \'autotag\':\\r\\n                    $tags = explode(\',\', $value);\\r\\n                    $newTags = array();\\r\\n                    foreach ($tags as $tag) {\\r\\n                        $newTags[] = trim($tag);\\r\\n                    }\\r\\n                    $value = implode(\',\', $newTags);\\r\\n\\r\\n                    break;\\r\\n                default:\\r\\n                    \\/* handles checkboxes & multiple selects elements *\\/\\r\\n                    if (is_array($value)) {\\r\\n                        $featureInsert = array();\\r\\n                        while (list($featureValue, $featureItem) = each($value)) {\\r\\n                            if (empty($featureItem)) {\\r\\n                                continue;\\r\\n                            }\\r\\n                            $featureInsert[count($featureInsert)] = $featureItem;\\r\\n                        }\\r\\n                        $value = implode(\'||\', $featureInsert);\\r\\n                    }\\r\\n\\r\\n                    break;\\r\\n            }\\r\\n            $reverting[$lang][$tvId] = $value;\\r\\n            $clearKeys[] = $k;\\r\\n        }\\r\\n\\r\\n        \\/**\\r\\n         * json seems to have number of characters limit;\\r\\n         * that makes saving success report truncated and output modal hangs,\\r\\n         * TV\'s proccessing does this outside of reverting\'s loops\\r\\n         *\\/\\r\\n        if (!empty($clearKeys)) {\\r\\n            foreach ($clearKeys as $k) {\\r\\n                $resource->set($k, \'\');\\r\\n            }\\r\\n        }\\r\\n\\r\\n        foreach ($reverting as $k => $tmplvars) {\\r\\n            foreach ($tmplvars as $key => $val) {\\r\\n                $lingua->setTVTranslation($resourceId, $k, $key, $val);\\r\\n            }\\r\\n        }\\r\\n\\r\\n        \\/\\/ clear cache\\r\\n        $contexts = array($resource->get(\'context_key\'));\\r\\n        $cacheManager = $modx->getCacheManager();\\r\\n        $cacheManager->refresh(array(\\r\\n            \'lingua\\/resource\' => array(\'contexts\' => $contexts),\\r\\n        ));\\r\\n        break;\\r\\n\\r\\n    case \'OnResourceDuplicate\':\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            $currentContext = $oldResource->get(\'context_key\');\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            $currentParent = $oldResource->get(\'parent\');\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n        if (!empty($ids)) {\\r\\n            $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n            $currentId = $oldResource->get(\'id\');\\r\\n            if (!in_array($currentId, $ids)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $linguaSiteContents = $modx->getCollection(\'linguaSiteContent\', array(\\r\\n            \'resource_id\' => $oldResource->get(\'id\')\\r\\n        ));\\r\\n        if ($linguaSiteContents) {\\r\\n            foreach ($linguaSiteContents as $linguaSiteContent) {\\r\\n                $params = $linguaSiteContent->toArray();\\r\\n                unset($params[\'id\']);\\r\\n                $params[\'resource_id\'] = $newResource->get(\'id\');\\r\\n                $newLinguaSiteContent = $modx->newObject(\'linguaSiteContent\');\\r\\n                $newLinguaSiteContent->fromArray($params);\\r\\n                $newLinguaSiteContent->save();\\r\\n            }\\r\\n        }\\r\\n        break;\\r\\n\\r\\n    case \'OnEmptyTrash\':\\r\\n        if (!empty($ids) && is_array($ids)) {\\r\\n            $collection = $modx->getCollection(\'linguaSiteContent\', array(\\r\\n                \'resource_id:IN\' => $ids\\r\\n            ));\\r\\n            if ($collection) {\\r\\n                foreach ($collection as $item) {\\r\\n                    $item->remove();\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n        break;\\r\\n\\r\\n    case \'OnTemplateSave\':\\r\\n    case \'OnTempFormSave\':\\r\\n    case \'OnTVFormSave\':\\r\\n    case \'OnSnipFormSave\':\\r\\n    case \'OnPluginFormSave\':\\r\\n    case \'OnMediaSourceFormSave\':\\r\\n    case \'OnChunkFormSave\':\\r\\n    case \'OnSiteRefresh\':\\r\\n        $cacheManager = $modx->getCacheManager();\\r\\n        $cacheManager->refresh(array(\\r\\n            \'lingua\\/resource\' => array(),\\r\\n        ));\\r\\n        break;\\r\\n\\r\\n    default:\\r\\n        break;\\r\\n}\\r\\nreturn;","locked":0,"properties":null,"disabled":0,"moduleguid":"","static":0,"static_file":"","content":"header(\'Content-Type: text\\/html; charset=utf-8\');\\r\\n\\/**\\r\\n * Lingua\\r\\n *\\r\\n * Copyright 2013-2015 by goldsky <goldsky@virtudraft.com>\\r\\n *\\r\\n * This file is part of Lingua, a MODX\'s Lexicon switcher for front-end interface\\r\\n *\\r\\n * Lingua is free software; you can redistribute it and\\/or modify it under the\\r\\n * terms of the GNU General Public License as published by the Free Software\\r\\n * Foundation version 3.\\r\\n *\\r\\n * Lingua is distributed in the hope that it will be useful, but WITHOUT ANY\\r\\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\\r\\n * A PARTICULAR PURPOSE. See the GNU General Public License for more details.\\r\\n *\\r\\n * You should have received a copy of the GNU General Public License along with\\r\\n * Lingua; if not, write to the Free Software Foundation, Inc., 59 Temple Place,\\r\\n * Suite 330, Boston, MA 02111-1307 USA\\r\\n *\\r\\n * @package lingua\\r\\n * @subpackage lingua_plugin\\r\\n *\\/\\r\\n$event = $modx->event->name;\\r\\nswitch ($event) {\\r\\n    case \'OnHandleRequest\': \\/\\/ for global\\r\\n        break;\\r\\n\\r\\n    case \'OnInitCulture\':   \\/\\/ for request class\\r\\n        if ($modx->context->key === \'mgr\') {\\r\\n            return;\\r\\n        }\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n        $modx->lexicon->load(\'lingua:default\');\\r\\n        $langGetKey = $modx->getOption(\'lingua.request_key\', $scriptProperties, \'lang\');\\r\\n        $langGetKeyValue = filter_input(INPUT_GET, $langGetKey, FILTER_SANITIZE_STRING);\\r\\n        $langGetKeyValue = strtolower($langGetKeyValue);\\r\\n        $langCookieValue = filter_input(INPUT_COOKIE, \'modx_lingua_switcher\', FILTER_SANITIZE_STRING);\\r\\n        $langCookieValue = strtolower($langCookieValue);\\r\\n        if (!empty($langGetKeyValue) &&\\r\\n                $langGetKeyValue !== $modx->cultureKey &&\\r\\n                strlen($langGetKeyValue) === 2\\r\\n        ) {\\r\\n            $lingua->setCultureKey($langGetKeyValue);\\r\\n        } else if (!empty($langCookieValue) &&\\r\\n                $langCookieValue !== $modx->cultureKey &&\\r\\n                strlen($langCookieValue) === 2\\r\\n        ) {\\r\\n            $lingua->setCultureKey($langCookieValue);\\r\\n        } else if(empty($langGetKeyValue) &&\\r\\n                empty($langCookieValue)\\r\\n        ){\\r\\n            $detectBrowser = $modx->getOption(\'lingua.detect_browser\');\\r\\n            if ($detectBrowser === \'1\') {\\r\\n                $languages = explode(\',\', filter_input(INPUT_SERVER, \'HTTP_ACCEPT_LANGUAGE\', FILTER_SANITIZE_STRING));\\r\\n                $sortedLangs = array();\\r\\n                foreach ($languages as $language) {\\r\\n                    $language = strtolower($language);\\r\\n                    $parts = @explode(\';\', $language);\\r\\n                    if (!isset($parts[1])) {\\r\\n                        $sort = 1.0;\\r\\n                    } else {\\r\\n                        $x = @explode(\'=\', $parts[1]);\\r\\n                        $sort = $x[1] - 0;\\r\\n                    }\\r\\n                    $sortedLangs[$parts[0]] = $sort;\\r\\n                }\\r\\n                arsort($sortedLangs);\\r\\n                $langs = array_keys($sortedLangs);\\r\\n                $linguaLangs = $modx->getCollection(\'linguaLangs\', array(\\r\\n                    \'active\' => 1\\r\\n                ));\\r\\n                $c = $modx->newQuery(\'linguaLangs\');\\r\\n                $c->where(\'active=1\');\\r\\n                $contextLangs = $modx->context->config[\'lingua.langs\'];\\r\\n                if (!empty($contextLangs)) {\\r\\n                    $contextLangs = array_map(\'trim\', @explode(\',\', $contextLangs));\\r\\n                    $c->where(array(\\r\\n                        \'lang_code:IN\' => $contextLangs\\r\\n                    ));\\r\\n                }\\r\\n                $linguaLangs = $modx->getCollection(\'linguaLangs\', $c);\\r\\n                $existingLangs = array();\\r\\n                if ($linguaLangs) {\\r\\n                    foreach ($linguaLangs as $linguaLang) {\\r\\n                        $existingLangs[] = $linguaLang->get(\'lang_code\');\\r\\n                    }\\r\\n                }\\r\\n\\r\\n                $acceptedLangs = array_intersect($existingLangs, $langs);\\r\\n                $acceptedLangs = array_values($acceptedLangs); \\/\\/ reset index\\r\\n\\r\\n                if (!empty($acceptedLangs) && is_array($acceptedLangs)) {\\r\\n                    $lingua->setCultureKey($acceptedLangs[0]);\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n        $modx->cultureKey = $lingua->getCultureKey();\\r\\n        if ($modx->cultureKey !== $modx->getOption(\'cultureKey\')) {\\r\\n            $modx->setOption(\'cultureKey\', $modx->cultureKey);\\r\\n            $modx->context->config[\'cultureKey\'] = $modx->cultureKey;\\r\\n        }\\r\\n        $modx->setPlaceholder(\'lingua.cultureKey\', $modx->cultureKey);\\r\\n        $modx->setPlaceholder(\'lingua.language\', $modx->cultureKey);\\r\\n\\r\\n        break;\\r\\n\\r\\n    \\/**\\r\\n     * \\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/ MANAGER SIDE \\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\r\\n     *\\/\\r\\n    case \'OnDocFormPrerender\':\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            if ($resource) {\\r\\n                $currentContext = $resource->get(\'context_key\');\\r\\n            } else {\\r\\n                $currentContext = filter_input(INPUT_GET, \'context_key\', FILTER_SANITIZE_STRING);\\r\\n            }\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            if ($resource) {\\r\\n                $currentParent = $resource->get(\'parent\');\\r\\n            } else {\\r\\n                $currentParent = filter_input(INPUT_GET, \'parent\', FILTER_SANITIZE_NUMBER_INT);\\r\\n            }\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        if (is_object($resource)) {\\r\\n            $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n            if (!empty($ids)) {\\r\\n                $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n                $currentId = $resource->get(\'id\');\\r\\n                if (!in_array($currentId, $ids)) {\\r\\n                    return;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        $modx->lexicon->load(\'lingua:default\');\\r\\n        $languages = $lingua->getLanguages();\\r\\n        if (empty($languages)) {\\r\\n            return;\\r\\n        }\\r\\n        $modx->regClientCSS(MODX_BASE_URL . \'assets\\/components\\/lingua\\/css\\/mgr.css\');\\r\\n        $modx->controller->addLastJavascript(MODX_BASE_URL . \'assets\\/components\\/lingua\\/js\\/mgr\\/resource.js\');\\r\\n        \\/\\/ $modx->getOption(\'cultureKey\') doesn\'t work!\\r\\n        $modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\r\\n        $cultureKey = $modCultureKey->get(\'value\');\\r\\n        $storeData = array();\\r\\n        $storeDefaultData = array();\\r\\n        $configLang = array();\\r\\n        $linguaSiteContentArray = array();\\r\\n        $createHiddenFields = array();\\r\\n        foreach ($languages as $language) {\\r\\n            $configLang[$language[\'lang_code\']] = array(\\r\\n                \'lang_code\' => $language[\'lang_code\'],\\r\\n                \'local_name\' => $language[\'local_name\'],\\r\\n                \'flag\' => $language[\'flag\'],\\r\\n            );\\r\\n            if ($language[\'lang_code\'] === $cultureKey) {\\r\\n                $storeDefaultData[] = array(\\r\\n                    $language[\'lang_code\'],\\r\\n                    $language[\'local_name\'],\\r\\n                    $language[\'flag\'],\\r\\n                );\\r\\n                continue;\\r\\n            }\\r\\n            $storeData[] = array(\\r\\n                $language[\'lang_code\'],\\r\\n                $language[\'local_name\'],\\r\\n                $language[\'flag\'],\\r\\n            );\\r\\n            if ($mode === modSystemEvent::MODE_UPD) {\\r\\n                $linguaSiteContent = $modx->getObject(\'linguaSiteContent\', array(\\r\\n                    \'resource_id\' => $resource->get(\'id\'),\\r\\n                    \'lang_id\' => $language[\'id\']\\r\\n                ));\\r\\n                if ($linguaSiteContent) {\\r\\n                    $linguaSiteContentArray[$language[\'lang_code\']] = $linguaSiteContent->toArray();\\r\\n                } else {\\r\\n                    $linguaSiteContentArray[$language[\'lang_code\']] = array();\\r\\n                }\\r\\n            } else {\\r\\n                $linguaSiteContentArray[$language[\'lang_code\']] = array();\\r\\n            }\\r\\n            $modx->regClientStartupHTMLBlock(\'<style>.icon-lingua-flag-\' . $language[\'lcid_string\'] . \' {background-image: url(\\\\\'..\\/\' . $language[\'flag\'] . \'\\\\\'); background-repeat: no-repeat;}<\\/style>\');\\r\\n            $createHiddenFields[] = $language;\\r\\n        } \\/\\/ foreach ($languages as $language)\\r\\n        \\/\\/------------------------------------------------------------------\\r\\n        $formCustomized = $modx->getOption(\'lingua.form_customization\');\\r\\n        $modx->controller->addHtml(\'\\r\\n<script type=\\"text\\/javascript\\">\\r\\nExt.onReady(function() {\\r\\n    window.lingua = new Lingua({\\r\\n        defaultLang: \\"\' . $cultureKey . \'\\",\\r\\n        langs: \' . json_encode($configLang) . \',\\r\\n        siteContent: \' . json_encode($linguaSiteContentArray) . \',\\r\\n        formCustomized: \' . $formCustomized . \'\\r\\n    });\\r\\n    lingua.flagDefaultFields();\\r\\n    lingua.createHiddenFields(\' . json_encode($createHiddenFields) . \');\\r\\n    lingua.getMenu({\\r\\n        storeData: \' . json_encode(array_merge($storeDefaultData, $storeData)) . \'\\r\\n    });\\r\\n});\\r\\n<\\/script>\');\\r\\n        if ($formCustomized) {\\r\\n            $modx->controller->addLastJavascript(MODX_BASE_URL . \'assets\\/components\\/lingua\\/js\\/mgr\\/fcinit.js\');\\r\\n        }\\r\\n        \\/\\/------------------------------------------------------------------\\r\\n        break;\\r\\n\\r\\n    case \'OnResourceTVFormRender\':\\r\\n        if (!is_object($resource) && is_numeric($resource)) {\\r\\n            $resourceId = $resource;\\r\\n            $resource = $modx->getObject(\'modResource\', $resource);\\r\\n        }\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            if ($resource) {\\r\\n                $currentContext = $resource->get(\'context_key\');\\r\\n            } else {\\r\\n                $currentContext = filter_input(INPUT_GET, \'context_key\', FILTER_SANITIZE_STRING);\\r\\n            }\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            if ($resource) {\\r\\n                $currentParent = $resource->get(\'parent\');\\r\\n            } else {\\r\\n                $currentParent = filter_input(INPUT_GET, \'parent\', FILTER_SANITIZE_NUMBER_INT);\\r\\n            }\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        if (is_object($resource)) {\\r\\n            $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n            if (!empty($ids)) {\\r\\n                $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n                $currentId = $resource->get(\'id\');\\r\\n                if (!in_array($currentId, $ids)) {\\r\\n                    return;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n        $languages = $lingua->getLanguages(true, false);\\r\\n        if (empty($languages)) {\\r\\n            return;\\r\\n        }\\r\\n        $initAllClonedTVFields = array();\\r\\n        foreach ($languages as $language) {\\r\\n            $initAllClonedTVFields[] = $language;\\r\\n        }\\r\\n\\r\\n        if ($resource) {\\r\\n            $tvs = $resource->getTemplateVars();\\r\\n        } else {\\r\\n            $templateId = $template;\\r\\n            $template = $modx->getObject(\'modTemplate\', $templateId);\\r\\n            $tvs = $template->getTemplateVars();\\r\\n        }\\r\\n        if (!$tvs) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        $tvIds = array();\\r\\n        $tvOutputs = array();\\r\\n        foreach ($tvs as $tv) {\\r\\n            $tvIds[] = $tv->get(\'id\');\\r\\n        }\\r\\n        $c = $modx->newQuery(\'linguaSiteTmplvars\');\\r\\n        $c->where(array(\\r\\n            \'tmplvarid:IN\' => $tvIds\\r\\n        ));\\r\\n        $linguaSiteTmplvars = $modx->getCollection(\'linguaSiteTmplvars\', $c);\\r\\n        if (!$linguaSiteTmplvars) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        $formElements = array();\\r\\n        foreach ($scriptProperties[\'categories\'] as $category) {\\r\\n            foreach ($category[\'tvs\'] as $tv) {\\r\\n                $formElements[$tv->get(\'id\')] = $tv;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        if (!empty($modx->controller->scriptProperties[\'showCheckbox\'])) {\\r\\n            $showCheckbox = 1;\\r\\n        }\\r\\n\\r\\n        $tmplvars = array();\\r\\n        $cloneTVFields = array();\\r\\n        $count = 0;\\r\\n        \\/\\/ $modx->getOption(\'cultureKey\') doesn\'t work!\\r\\n        $modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\r\\n        $cultureKey = $modCultureKey->get(\'value\');\\r\\n        foreach ($linguaSiteTmplvars as $linguaTv) {\\r\\n            $tvId = $linguaTv->get(\'tmplvarid\');\\r\\n            if (!isset($formElements[$tvId])) {\\r\\n                continue;\\r\\n            }\\r\\n            $tv = $formElements[$tvId];\\r\\n            $tmplvars[] = array(\\r\\n                \'id\' => $tvId,\\r\\n                \'type\' => $tv->get(\'type\'),\\r\\n            );\\r\\n            $tvArray = $tv->toArray(\'tv.\');\\r\\n            foreach ($languages as $language) {\\r\\n                if ($language[\'lang_code\'] === $cultureKey) {\\r\\n                    continue;\\r\\n                }\\r\\n                $linguaTVContent = $modx->getObject(\'linguaSiteTmplvarContentvalues\', array(\\r\\n                    \'tmplvarid\' => $tvId,\\r\\n                    \'contentid\' => $resourceId,\\r\\n                    \'lang_id\' => $language[\'id\']\\r\\n                ));\\r\\n                \\/\\/ Start to manipulate the ID to parse hidden TVs\\r\\n                $content = \'\';\\r\\n                if ($linguaTVContent) {\\r\\n                    $content = $linguaTVContent->get(\'value\');\\r\\n                }\\r\\n                \\/\\/ Hack TV\'s value because renderInput ignores empty value\\r\\n                $tv->set(\'value\', $content);\\r\\n                $inputForm = $tv->renderInput($resource, array(\\r\\n                    \'value\' => $content\\r\\n                ));\\r\\n                if (empty($inputForm)) {\\r\\n                    continue;\\r\\n                }\\r\\n                $tvCloneId = $tvId . \'_\' . $language[\'lang_code\'] . \'_lingua_tv\';\\r\\n                \\/\\/ basic replacements\\r\\n                $cloneInputForm = $inputForm;\\r\\n                $cloneInputForm = preg_replace(\'\\/(\\"|\\\\\'){1}tv\' . $tvId . \'(\\"|\\\\\'){1}\\/\', \'${1}tv\' . $tvCloneId . \'${2}\', $cloneInputForm);\\r\\n                $cloneInputForm = preg_replace(\'\\/(\\"|\\\\\'){1}tv\' . $tvId . \'\\\\[\\\\](\\"|\\\\\'){1}\\/\', \'${1}tv\' . $tvCloneId . \'[]${2}\', $cloneInputForm);\\r\\n                \\/\\/ advanced replacements\\r\\n                $linguaSiteTmplvarsPatterns = $modx->getCollection(\'linguaSiteTmplvarsPatterns\', array(\\r\\n                    \'type\' => $tv->get(\'type\')\\r\\n                ));\\r\\n                if ($linguaSiteTmplvarsPatterns) {\\r\\n                    foreach ($linguaSiteTmplvarsPatterns as $pattern) {\\r\\n                        $search = $pattern->get(\'search\');\\r\\n                        $search = str_replace(\'{{tvId}}\', $tvId, $search);\\r\\n                        $replacement = $pattern->get(\'replacement\');\\r\\n                        $replacement = str_replace(\'{{tvCloneId}}\', $tvCloneId, $replacement);\\r\\n                        $cloneInputForm = preg_replace($search, $replacement, $cloneInputForm);\\r\\n                    }\\r\\n                }\\r\\n                $count++;\\r\\n                $phs = $tvArray;\\r\\n                $phs[\'tv.id\'] = $tvCloneId;\\r\\n                $phs[\'tv.formElement\'] = $cloneInputForm;\\r\\n                $phs[\'tv.showCheckbox\'] = $showCheckbox;\\r\\n                $cloneTVFields[] = $lingua->processElementTags($lingua->parseTpl(\'lingua.resourcetv.row\', $phs));\\r\\n            }\\r\\n        }\\r\\n\\r\\n        \\/\\/ reset any left out output after rendering TV forms above\\r\\n        if ($modx->event->name === \'OnTVInputRenderList\') {\\r\\n            $modx->event->_output = \'\';\\r\\n        }\\r\\n        $modx->event->output(@implode(\\"\\\\n\\", $cloneTVFields));\\r\\n        $jsHTML = \\"\\r\\n<script>\\r\\n    Ext.onReady(function() {\\r\\n        lingua.config.tmplvars = \\" . json_encode($tmplvars) . \\";\\r\\n        lingua.initAllClonedTVFields(\\" . json_encode($initAllClonedTVFields) . \\");\\r\\n        lingua.flagDefaultTVFields();\\r\\n    });\\r\\n<\\/script>\\";\\r\\n        $modx->event->output($jsHTML);\\r\\n\\r\\n        break;\\r\\n\\r\\n    case \'OnDocFormSave\':\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            $currentContext = $resource->get(\'context_key\');\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            $currentParent = $resource->get(\'parent\');\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n        if (!empty($ids)) {\\r\\n            $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n            $currentId = $resource->get(\'id\');\\r\\n            if (!in_array($currentId, $ids)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $lingua = $modx->getService(\'lingua\', \'Lingua\', MODX_CORE_PATH . \'components\\/lingua\\/model\\/lingua\\/\');\\r\\n        if (!($lingua instanceof Lingua)) {\\r\\n            return;\\r\\n        }\\r\\n\\r\\n        \\/\\/ update linguaSiteContent\\r\\n        $reverting = array();\\r\\n        $clearKeys = array();\\r\\n        \\/\\/ $modx->getOption(\'cultureKey\') doesn\'t work!\\r\\n        $modCultureKey = $modx->getObject(\'modSystemSetting\', array(\'key\' => \'cultureKey\'));\\r\\n        $cultureKey = $modCultureKey->get(\'value\');\\r\\n        foreach ($resource->_fields as $k => $v) {\\r\\n            if (!preg_match(\'\\/_lingua$\\/\', $k)) {\\r\\n                continue;\\r\\n            }\\r\\n            foreach ($v as $a => $b) {\\r\\n                if ($a === $cultureKey) {\\r\\n                    continue;\\r\\n                }\\r\\n                $reverting[$a][preg_replace(\'\\/_lingua$\\/\', \'\', $k)] = $b;\\r\\n            }\\r\\n            $clearKeys[] = $k;\\r\\n        }\\r\\n\\r\\n        $resourceId = $resource->get(\'id\');\\r\\n        foreach ($reverting as $k => $v) {\\r\\n            $lingua->setContentTranslation($resourceId, $k, $v);\\r\\n        }\\r\\n\\r\\n        \\/\\/ update linguaSiteTmplvarContentvalues\\r\\n        $reverting = array();\\r\\n        foreach ($resource->_fields as $k => $value) {\\r\\n            if (!preg_match(\'\\/_lingua_tv$\\/\', $k)) {\\r\\n                continue;\\r\\n            }\\r\\n            $tvKey = preg_replace(\'\\/_lingua_tv$\\/\', \'\', $k);\\r\\n            $tvKeys = @explode(\'_\', $tvKey);\\r\\n            $tvId = str_replace(\'tv\', \'\', $tvKeys[0]);\\r\\n            if (!is_numeric($tvId)) {\\r\\n                continue;\\r\\n            }\\r\\n            $reverse = array_reverse($tvKeys);\\r\\n            $lang = $reverse[0];\\r\\n            if ($lang === $cultureKey) {\\r\\n                continue;\\r\\n            }\\r\\n            $tv = $modx->getObject(\'modTemplateVar\', $tvId);\\r\\n            $tvKey = $tvKeys[0];\\r\\n            \\/* validation for different types *\\/\\r\\n            switch ($tv->get(\'type\')) {\\r\\n                case \'url\':\\r\\n                    \\/\\/ tv16_prefix_id_lingua_tv\\r\\n                    $prefix = $resource->_fields[$tvKey . \'_prefix_\' . $lang . \'_lingua_tv\'];\\r\\n                    if ($prefix != \'--\') {\\r\\n                        $value = str_replace(array(\'ftp:\\/\\/\', \'http:\\/\\/\', \'https:\\/\\/\', \'ftp:\\/\\/\', \'mailto:\'), \'\', $value);\\r\\n                        $value = $prefix . $value;\\r\\n                    }\\r\\n                    $reverting[$lang][$tvId] = $value;\\r\\n\\r\\n                    break;\\r\\n                case \'date\':\\r\\n                    $value = empty($value) ? \'\' : strftime(\'%Y-%m-%d %H:%M:%S\', strtotime($value));\\r\\n\\r\\n                    break;\\r\\n                \\/* ensure tag types trim whitespace from tags *\\/\\r\\n                case \'tag\':\\r\\n                case \'autotag\':\\r\\n                    $tags = explode(\',\', $value);\\r\\n                    $newTags = array();\\r\\n                    foreach ($tags as $tag) {\\r\\n                        $newTags[] = trim($tag);\\r\\n                    }\\r\\n                    $value = implode(\',\', $newTags);\\r\\n\\r\\n                    break;\\r\\n                default:\\r\\n                    \\/* handles checkboxes & multiple selects elements *\\/\\r\\n                    if (is_array($value)) {\\r\\n                        $featureInsert = array();\\r\\n                        while (list($featureValue, $featureItem) = each($value)) {\\r\\n                            if (empty($featureItem)) {\\r\\n                                continue;\\r\\n                            }\\r\\n                            $featureInsert[count($featureInsert)] = $featureItem;\\r\\n                        }\\r\\n                        $value = implode(\'||\', $featureInsert);\\r\\n                    }\\r\\n\\r\\n                    break;\\r\\n            }\\r\\n            $reverting[$lang][$tvId] = $value;\\r\\n            $clearKeys[] = $k;\\r\\n        }\\r\\n\\r\\n        \\/**\\r\\n         * json seems to have number of characters limit;\\r\\n         * that makes saving success report truncated and output modal hangs,\\r\\n         * TV\'s proccessing does this outside of reverting\'s loops\\r\\n         *\\/\\r\\n        if (!empty($clearKeys)) {\\r\\n            foreach ($clearKeys as $k) {\\r\\n                $resource->set($k, \'\');\\r\\n            }\\r\\n        }\\r\\n\\r\\n        foreach ($reverting as $k => $tmplvars) {\\r\\n            foreach ($tmplvars as $key => $val) {\\r\\n                $lingua->setTVTranslation($resourceId, $k, $key, $val);\\r\\n            }\\r\\n        }\\r\\n\\r\\n        \\/\\/ clear cache\\r\\n        $contexts = array($resource->get(\'context_key\'));\\r\\n        $cacheManager = $modx->getCacheManager();\\r\\n        $cacheManager->refresh(array(\\r\\n            \'lingua\\/resource\' => array(\'contexts\' => $contexts),\\r\\n        ));\\r\\n        break;\\r\\n\\r\\n    case \'OnResourceDuplicate\':\\r\\n        $contexts = $modx->getOption(\'lingua.contexts\', $scriptProperties, \'web\');\\r\\n        if (!empty($contexts)) {\\r\\n            $contexts = array_map(\'trim\', @explode(\',\', $contexts));\\r\\n            $currentContext = $oldResource->get(\'context_key\');\\r\\n            if (!in_array($currentContext, $contexts)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $parents = $modx->getOption(\'lingua.parents\', $scriptProperties);\\r\\n        if (!empty($parents)) {\\r\\n            $parents = array_map(\'trim\', @explode(\',\', $parents));\\r\\n            $currentParent = $oldResource->get(\'parent\');\\r\\n            if (!in_array($currentParent, $parents)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n        $ids = $modx->getOption(\'lingua.ids\', $scriptProperties);\\r\\n        if (!empty($ids)) {\\r\\n            $ids = array_map(\'trim\', @explode(\',\', $ids));\\r\\n            $currentId = $oldResource->get(\'id\');\\r\\n            if (!in_array($currentId, $ids)) {\\r\\n                return;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        $linguaSiteContents = $modx->getCollection(\'linguaSiteContent\', array(\\r\\n            \'resource_id\' => $oldResource->get(\'id\')\\r\\n        ));\\r\\n        if ($linguaSiteContents) {\\r\\n            foreach ($linguaSiteContents as $linguaSiteContent) {\\r\\n                $params = $linguaSiteContent->toArray();\\r\\n                unset($params[\'id\']);\\r\\n                $params[\'resource_id\'] = $newResource->get(\'id\');\\r\\n                $newLinguaSiteContent = $modx->newObject(\'linguaSiteContent\');\\r\\n                $newLinguaSiteContent->fromArray($params);\\r\\n                $newLinguaSiteContent->save();\\r\\n            }\\r\\n        }\\r\\n        break;\\r\\n\\r\\n    case \'OnEmptyTrash\':\\r\\n        if (!empty($ids) && is_array($ids)) {\\r\\n            $collection = $modx->getCollection(\'linguaSiteContent\', array(\\r\\n                \'resource_id:IN\' => $ids\\r\\n            ));\\r\\n            if ($collection) {\\r\\n                foreach ($collection as $item) {\\r\\n                    $item->remove();\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n        break;\\r\\n\\r\\n    case \'OnTemplateSave\':\\r\\n    case \'OnTempFormSave\':\\r\\n    case \'OnTVFormSave\':\\r\\n    case \'OnSnipFormSave\':\\r\\n    case \'OnPluginFormSave\':\\r\\n    case \'OnMediaSourceFormSave\':\\r\\n    case \'OnChunkFormSave\':\\r\\n    case \'OnSiteRefresh\':\\r\\n        $cacheManager = $modx->getCacheManager();\\r\\n        $cacheManager->refresh(array(\\r\\n            \'lingua\\/resource\' => array(),\\r\\n        ));\\r\\n        break;\\r\\n\\r\\n    default:\\r\\n        break;\\r\\n}\\r\\nreturn;"}',
        'guid' => '7cfbd21b4e0771e2b4762ea4f43e553e',
        'native_key' => 0,
        'signature' => '192a4553b4edce0ff4ab57f4312b4e2d',
        'related_objects' => 
        array (
          'PluginEvents' => 
          array (
            '002efd63407cd98974898c69ed536637' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnHandleRequest","priority":0,"propertyset":0}',
              'guid' => 'c6c1905efc9c5c53843c1de2262a4ccc',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnHandleRequest',
              ),
              'signature' => 'ae130a3d4954cdeab8ca9820ab3a38bc',
            ),
            '2e851a560c562c7f99f4a1fc4c259b8d' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnInitCulture","priority":0,"propertyset":0}',
              'guid' => 'cfb19b0029de67136e67613c6e2e7d07',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnInitCulture',
              ),
              'signature' => 'f6f813cf5a79cdd749fc19a4c26dfe1a',
            ),
            '615e8bd4266b25f06f10d1054e1cfe17' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnDocFormPrerender","priority":0,"propertyset":0}',
              'guid' => '2f5d53d61558777018e2b09dc94045c5',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnDocFormPrerender',
              ),
              'signature' => '444f097198e2367c1ed6ecce94a83df8',
            ),
            '50d345b691cc7be9b55133524183374c' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnResourceTVFormRender","priority":0,"propertyset":0}',
              'guid' => 'ba193ed1a348e6aea1bd36b8948e2717',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnResourceTVFormRender',
              ),
              'signature' => '88d70afc3356d28034b573c227b344ef',
            ),
            'ec2fac19e3efc544b0f4c9688fa1ce9a' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnDocFormSave","priority":0,"propertyset":0}',
              'guid' => 'bc98c53752143634ac1984a4681bd073',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnDocFormSave',
              ),
              'signature' => '9bbaf798b6de5d064422e864099d956f',
            ),
            '48309a2d8dcfe0935e72570240a103da' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnResourceDuplicate","priority":0,"propertyset":0}',
              'guid' => '3dddfef1c3e514e3c16473d166056c6d',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnResourceDuplicate',
              ),
              'signature' => '06e3391d045f66853b20d9bd73089ee6',
            ),
            '30ad35b4ae46f1b331f3c23f17c3315e' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnEmptyTrash","priority":0,"propertyset":0}',
              'guid' => '7af0e0344376630743e40650bd8df84b',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnEmptyTrash',
              ),
              'signature' => 'f7a7765534492388236672910c7017d5',
            ),
            '7654324067cae3a7e9645745d8c7f5a2' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnTemplateSave","priority":0,"propertyset":0}',
              'guid' => '45634f44938d75fc3cd8f35f1992b863',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnTemplateSave',
              ),
              'signature' => 'ee002981ce03e3dc876c38870ee535a7',
            ),
            'c14547b1d1e5903b369fa626195261cc' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnTempFormSave","priority":0,"propertyset":0}',
              'guid' => 'd8eef6f67e951bb52cc9a3e27cdd237e',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnTempFormSave',
              ),
              'signature' => '47a3f6ddbf8ac38d2f73ec243d86d3ca',
            ),
            '094dc6c354582f10dd5c73fb03d4fbb0' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnTVFormSave","priority":0,"propertyset":0}',
              'guid' => '3d8721b2561bb467adf3e7a6baa9fa7b',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnTVFormSave',
              ),
              'signature' => '012a74ab4aaabe17312ac6eadf77538f',
            ),
            '75d209cada7f7d0f3a1eab6131613e85' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnSnipFormSave","priority":0,"propertyset":0}',
              'guid' => 'f1f99f7081f8787cdf865844261745a2',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnSnipFormSave',
              ),
              'signature' => '3ff618a964e23f54039562a44780b9c7',
            ),
            '545257a0e960a7ebfa5577c75a3c057e' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnPluginFormSave","priority":0,"propertyset":0}',
              'guid' => '729268ec2905c5e50c9aa3c27bac1a09',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnPluginFormSave',
              ),
              'signature' => '39628157bf16e4b62df0d336937a89f0',
            ),
            'b606adf08fa014cf9e5f5ff9df358ee5' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnMediaSourceFormSave","priority":0,"propertyset":0}',
              'guid' => '3977a201c21785fa51593146040fec80',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnMediaSourceFormSave',
              ),
              'signature' => '1890b59dd79f8c84f81b5f3cf1c49146',
            ),
            '43f16c4de7d14ae970a805af95310caa' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnChunkFormSave","priority":0,"propertyset":0}',
              'guid' => 'fdb848651edaf354bec18628e0cf74f0',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnChunkFormSave',
              ),
              'signature' => '6fcf30ccf05dddd41c1637dfe31dfa7b',
            ),
            '328b18786c9b56013659f872dfb06d09' => 
            array (
              'preserve_keys' => true,
              'update_object' => false,
              'unique_key' => 
              array (
                0 => 'pluginid',
                1 => 'event',
              ),
              'class' => 'modPluginEvent',
              'object' => '{"pluginid":0,"event":"OnSiteRefresh","priority":0,"propertyset":0}',
              'guid' => '638fe6ed524d03739cb4ff6019820ed0',
              'native_key' => 
              array (
                0 => 0,
                1 => 'OnSiteRefresh',
              ),
              'signature' => 'f174a21462310ee45051f8c8d2a96265',
            ),
          ),
        ),
      ),
    ),
  ),
  'related_object_attributes' => 
  array (
    'Snippets' => 
    array (
      'preserve_keys' => false,
      'update_object' => true,
      'unique_key' => 'name',
    ),
    'Chunks' => 
    array (
      'preserve_keys' => false,
      'update_object' => true,
      'unique_key' => 'name',
    ),
    'Plugins' => 
    array (
      'preserve_keys' => false,
      'update_object' => true,
      'unique_key' => 'name',
    ),
    'PluginEvents' => 
    array (
      'preserve_keys' => true,
      'update_object' => false,
      'unique_key' => 
      array (
        0 => 'pluginid',
        1 => 'event',
      ),
    ),
  ),
  'namespace' => 'lingua',
  'resolve' => 
  array (
    0 => 
    array (
      'type' => 'file',
      'body' => '{"source":"lingua-2.1.0-beta4\\/modCategory\\/253054f870ce3b4dd70978aaabfdb517\\/0\\/","target":"return MODX_CORE_PATH . \'components\\/\';","name":"lingua"}',
    ),
    1 => 
    array (
      'type' => 'file',
      'body' => '{"source":"lingua-2.1.0-beta4\\/modCategory\\/253054f870ce3b4dd70978aaabfdb517\\/1\\/","target":"return MODX_ASSETS_PATH . \'components\\/\';","name":"lingua"}',
    ),
    2 => 
    array (
      'type' => 'php',
      'body' => '{"source":"lingua-2.1.0-beta4\\/modCategory\\/253054f870ce3b4dd70978aaabfdb517.tables.resolver.resolver","type":"php","name":"tables.resolver"}',
    ),
  ),
  'validate' => 
  array (
    0 => 
    array (
      'type' => 'php',
      'body' => '{"source":"lingua-2.1.0-beta4\\/modCategory\\/253054f870ce3b4dd70978aaabfdb517.tables.validator.validator","type":"php","name":"tables.validator"}',
    ),
  ),
  'vehicle_package' => 'transport',
  'vehicle_class' => 'xPDOObjectVehicle',
  'guid' => 'f5b1b01cf9cd47908d8ddd97ce971a09',
  'package' => 'modx',
  'class' => 'modCategory',
  'signature' => '253054f870ce3b4dd70978aaabfdb517',
  'native_key' => 1,
  'object' => '{"id":1,"parent":0,"category":"Lingua"}',
);